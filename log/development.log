DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[35m (108.8ms)[0m  [1m[35mCREATE DATABASE "skyva_api" ENCODING = 'unicode'[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE DATABASE "skyva_api" ENCODING = 'unicode'[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[35m (9.4ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[35m (8.4ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3422183495574815895)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to DeviseTokenAuthCreateUsers (20230819204134)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (8.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" bigserial primary key, "provider" character varying DEFAULT 'email' NOT NULL, "uid" character varying DEFAULT '' NOT NULL, "encrypted_password" character varying DEFAULT '' NOT NULL, "reset_password_token" character varying, "reset_password_sent_at" timestamp(6), "allow_password_change" boolean DEFAULT FALSE, "remember_created_at" timestamp(6), "confirmation_token" character varying, "confirmed_at" timestamp(6), "confirmation_sent_at" timestamp(6), "unconfirmed_email" character varying, "name" character varying, "nickname" character varying, "image" character varying, "email" character varying, "tokens" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (3.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_users_on_email" ON "users" ("email")[0m
  [1m[35m (3.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_users_on_uid_and_provider" ON "users" ("uid", "provider")[0m
  [1m[35m (3.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_users_on_reset_password_token" ON "users" ("reset_password_token")[0m
  [1m[35m (3.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_users_on_confirmation_token" ON "users" ("confirmation_token")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20230819204134"]]
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[35mCOMMIT[0m
Migrating to AddRoleToUsers (20230821020342)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[35mALTER TABLE "users" ADD "role" integer[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20230821020342"]]
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreatePosts (20230821021958)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "posts" ("id" bigserial primary key, "title" character varying, "content" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20230821021958"]]
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateActiveStorageTables (20230821023831)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" bigserial primary key, "key" character varying NOT NULL, "filename" character varying NOT NULL, "content_type" character varying, "metadata" text, "service_name" character varying NOT NULL, "byte_size" bigint NOT NULL, "checksum" character varying, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (3.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (8.5ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" bigserial primary key, "name" character varying NOT NULL, "record_type" character varying NOT NULL, "record_id" bigint NOT NULL, "blob_id" bigint NOT NULL, "created_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_c3b3935057"
FOREIGN KEY ("blob_id")
  REFERENCES "active_storage_blobs" ("id")
)[0m
  [1m[35m (3.6ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (3.7ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "active_storage_variant_records" ("id" bigserial primary key, "blob_id" bigint NOT NULL, "variation_digest" character varying NOT NULL, CONSTRAINT "fk_rails_993965df05"
FOREIGN KEY ("blob_id")
  REFERENCES "active_storage_blobs" ("id")
)[0m
  [1m[35m (4.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_variant_records_uniqueness" ON "active_storage_variant_records" ("blob_id", "variation_digest")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20230821023831"]]
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateProducts (20230928093423)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (8.2ms)[0m  [1m[35mCREATE TABLE "products" ("id" bigserial primary key, "name" character varying, "description" text, "price" decimal, "size" character varying, "color" character varying, "brand" character varying, "stock_quantity" integer, "category_id" bigint NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_fb915499a4"
FOREIGN KEY ("category_id")
  REFERENCES "categories" ("id")
)[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(3422183495574815895)[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[35m (0.2ms)[0m  [1m[35mCREATE DATABASE "skyva_api" ENCODING = 'unicode'[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE DATABASE "skyva_api" ENCODING = 'unicode'[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3422183495574815895)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateProducts (20230928093423)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (9.1ms)[0m  [1m[35mCREATE TABLE "products" ("id" bigserial primary key, "name" character varying, "description" text, "price" decimal, "size" character varying, "color" character varying, "brand" character varying, "stock_quantity" integer, "category_id" bigint NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_fb915499a4"
FOREIGN KEY ("category_id")
  REFERENCES "categories" ("id")
)[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(3422183495574815895)[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[35m (0.2ms)[0m  [1m[35mCREATE DATABASE "skyva_api" ENCODING = 'unicode'[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE DATABASE "skyva_api" ENCODING = 'unicode'[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3422183495574815895)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateCategories (20230928093441)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (8.5ms)[0m  [1m[35mCREATE TABLE "categories" ("id" bigserial primary key, "name" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20230928093441"]]
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateOrders (20230928093450)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "user_id" bigint NOT NULL, "status" character varying, "total_amount" decimal, "shipping_address" text, "payment_details" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_f868b47f6a"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (3.6ms)[0m  [1m[35mCREATE INDEX "index_orders_on_user_id" ON "orders" ("user_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20230928093450"]]
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateOrderItems (20230928093507)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (8.4ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" bigint NOT NULL, "product_id" bigint NOT NULL, "quantity" integer, "price" decimal, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_e3cb28f071"
FOREIGN KEY ("order_id")
  REFERENCES "orders" ("id")
, CONSTRAINT "fk_rails_f1a29ddd47"
FOREIGN KEY ("product_id")
  REFERENCES "products" ("id")
)[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT pg_advisory_unlock(3422183495574815895)[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3422183495574815895)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateProducts (20230928093423)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (15.7ms)[0m  [1m[35mCREATE TABLE "products" ("id" bigserial primary key, "name" character varying, "description" text, "price" decimal, "size" character varying, "color" character varying, "brand" character varying, "stock_quantity" integer, "category_id" bigint NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_fb915499a4"
FOREIGN KEY ("category_id")
  REFERENCES "categories" ("id")
)[0m
  [1m[35m (3.6ms)[0m  [1m[35mCREATE INDEX "index_products_on_category_id" ON "products" ("category_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20230928093423"]]
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateOrderItems (20230928093507)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (8.7ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" bigint NOT NULL, "product_id" bigint NOT NULL, "quantity" integer, "price" decimal, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_e3cb28f071"
FOREIGN KEY ("order_id")
  REFERENCES "orders" ("id")
, CONSTRAINT "fk_rails_f1a29ddd47"
FOREIGN KEY ("product_id")
  REFERENCES "products" ("id")
)[0m
  [1m[35m (4.0ms)[0m  [1m[35mCREATE INDEX "index_order_items_on_order_id" ON "order_items" ("order_id")[0m
  [1m[35m (4.1ms)[0m  [1m[35mCREATE INDEX "index_order_items_on_product_id" ON "order_items" ("product_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20230928093507"]]
  [1m[36mTRANSACTION (2.4ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateCarts (20230928093648)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "carts" ("id" bigserial primary key, "user_id" bigint NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_ea59a35211"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (4.0ms)[0m  [1m[35mCREATE INDEX "index_carts_on_user_id" ON "carts" ("user_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20230928093648"]]
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateAddresses (20230928093657)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (7.8ms)[0m  [1m[35mCREATE TABLE "addresses" ("id" bigserial primary key, "user_id" bigint NOT NULL, "address_type" character varying, "street" character varying, "city" character varying, "state" character varying, "postal_code" character varying, "country" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_48c9e0c5a2"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (3.2ms)[0m  [1m[35mCREATE INDEX "index_addresses_on_user_id" ON "addresses" ("user_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20230928093657"]]
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateReceipts (20230928094034)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (4.4ms)[0m  [1m[35mCREATE TABLE "receipts" ("id" bigserial primary key, "order_id" bigint NOT NULL, "user_id" bigint NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_de8c1572cc"
FOREIGN KEY ("order_id")
  REFERENCES "orders" ("id")
, CONSTRAINT "fk_rails_b2d4d3fa14"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (3.4ms)[0m  [1m[35mCREATE INDEX "index_receipts_on_order_id" ON "receipts" ("order_id")[0m
  [1m[35m (3.6ms)[0m  [1m[35mCREATE INDEX "index_receipts_on_user_id" ON "receipts" ("user_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20230928094034"]]
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.5ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2023-09-28 10:42:47.188783"], ["updated_at", "2023-09-28 10:42:47.188783"]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT pg_advisory_unlock(3422183495574815895)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3422183495574815895)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(3422183495574815895)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from block (3 levels) in <class:Railtie> at /home/markpaul/.rbenv/versions/2.7.6/lib/ruby/gems/2.7.0/gems/actionpack-7.0.7/lib/action_controller/railtie.rb:80)
Started GET "/categories/1/posts" for 127.0.0.1 at 2023-09-28 15:44:31 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
ActionController::RoutingError (No route matches [GET] "/categories/1/posts"):
  
Started GET "/categories/1/posts" for 127.0.0.1 at 2023-09-28 15:44:32 +0300
  
ActionController::RoutingError (No route matches [GET] "/categories/1/posts"):
  
Started GET "/product/new" for 127.0.0.1 at 2023-09-28 15:44:51 +0300
  
ActionController::RoutingError (No route matches [GET] "/product/new"):
  
Started GET "/product/new" for 127.0.0.1 at 2023-09-28 15:45:14 +0300
  
ActionController::RoutingError (No route matches [GET] "/product/new"):
  
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from block (3 levels) in <class:Railtie> at /home/markpaul/.rbenv/versions/2.7.6/lib/ruby/gems/2.7.0/gems/actionpack-7.0.7/lib/action_controller/railtie.rb:80)
Started GET "/product/new" for 127.0.0.1 at 2023-09-28 15:45:25 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
ActionController::RoutingError (No route matches [GET] "/product/new"):
  
Started GET "/product" for 127.0.0.1 at 2023-09-28 15:47:59 +0300
  
ActionController::RoutingError (No route matches [GET] "/product"):
  
Started GET "/products" for 127.0.0.1 at 2023-09-28 15:48:12 +0300
  
ActionController::RoutingError (No route matches [GET] "/products"):
  
Started GET "/create_product" for 127.0.0.1 at 2023-09-28 15:48:41 +0300
  
ActionController::RoutingError (No route matches [GET] "/create_product"):
  
Started POST "/create_product" for 127.0.0.1 at 2023-09-28 15:49:52 +0300
  
ActionController::RoutingError (No route matches [POST] "/create_product"):
  
Started POST "/create_product" for 127.0.0.1 at 2023-09-28 15:50:08 +0300
Processing by ProductsController#create as */*
  Parameters: {"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "color"=>"Blue", "category_id"=>1}
Completed 400 Bad Request in 3ms (ActiveRecord: 0.0ms | Allocations: 2129)


  
ActionController::ParameterMissing (param is missing or the value is empty: product):
  
app/controllers/products_controller.rb:19:in `product_params'
app/controllers/products_controller.rb:5:in `create'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/create_product" for 127.0.0.1 at 2023-09-28 15:50:17 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by ProductsController#create as */*
  Parameters: {"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "color"=>"Blue", "category_id"=>1}
Completed 400 Bad Request in 2ms (ActiveRecord: 0.0ms | Allocations: 2131)


  
ActionController::ParameterMissing (param is missing or the value is empty: product):
  
app/controllers/products_controller.rb:19:in `product_params'
app/controllers/products_controller.rb:5:in `create'
Started POST "/create_product" for 127.0.0.1 at 2023-09-28 15:52:56 +0300
Processing by ProductsController#create as */*
  Parameters: {"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "color"=>"Blue", "category_id"=>1}
Completed 400 Bad Request in 2ms (ActiveRecord: 0.0ms | Allocations: 1605)


  
ActionController::ParameterMissing (param is missing or the value is empty: product):
  
app/controllers/products_controller.rb:18:in `product_params'
app/controllers/products_controller.rb:5:in `create'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/create_product" for 127.0.0.1 at 2023-09-28 15:53:03 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by ProductsController#create as */*
  Parameters: {"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "color"=>"Blue", "category_id"=>1}
Completed 400 Bad Request in 3ms (ActiveRecord: 0.0ms | Allocations: 2131)


  
ActionController::ParameterMissing (param is missing or the value is empty: product):
  
app/controllers/products_controller.rb:18:in `product_params'
app/controllers/products_controller.rb:5:in `create'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/create_product" for 127.0.0.1 at 2023-09-28 15:53:54 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "color"=>"Blue", "category_id"=>1}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:7:in `create'
  [1m[36mCategory Load (0.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/products_controller.rb:7:in `create'
Completed 500 Internal Server Error in 46ms (ActiveRecord: 7.3ms | Allocations: 30510)


  
ActionView::MissingTemplate (Missing template products/new, application/new with {:locale=>[:en], :formats=>[:html, :text, :js, :css, :ics, :csv, :vcf, :vtt, :png, :jpeg, :gif, :bmp, :tiff, :svg, :mpeg, :mp3, :ogg, :m4a, :webm, :mp4, :otf, :ttf, :woff, :woff2, :xml, :rss, :atom, :yaml, :multipart_form, :url_encoded_form, :json, :pdf, :zip, :gzip], :variants=>[], :handlers=>[:raw, :erb, :html, :builder, :ruby]}.

Searched in:
  * "/home/markpaul/projects/skyva-api/app/views"
  * "/home/markpaul/.rbenv/versions/2.7.6/lib/ruby/gems/2.7.0/gems/devise_token_auth-1.2.2/app/views"
  * "/home/markpaul/.rbenv/versions/2.7.6/lib/ruby/gems/2.7.0/gems/devise-4.9.2/app/views"

Did you mean?  devise/confirmations/new
               devise/registrations/new
               devise/sessions/new
               devise/unlocks/new
               devise/passwords/new
               devise/registrations/edit):
  
app/controllers/products_controller.rb:10:in `create'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/create_product" for 127.0.0.1 at 2023-09-28 15:55:00 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "color"=>"Blue", "category_id"=>1}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:7:in `create'
  [1m[36mCategory Load (0.4ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/products_controller.rb:7:in `create'
Completed 500 Internal Server Error in 35ms (ActiveRecord: 7.3ms | Allocations: 30496)


  
ActionView::MissingTemplate (Missing template products/index, application/index with {:locale=>[:en], :formats=>[:html, :text, :js, :css, :ics, :csv, :vcf, :vtt, :png, :jpeg, :gif, :bmp, :tiff, :svg, :mpeg, :mp3, :ogg, :m4a, :webm, :mp4, :otf, :ttf, :woff, :woff2, :xml, :rss, :atom, :yaml, :multipart_form, :url_encoded_form, :json, :pdf, :zip, :gzip], :variants=>[], :handlers=>[:raw, :erb, :html, :builder, :ruby]}.

Searched in:
  * "/home/markpaul/projects/skyva-api/app/views"
  * "/home/markpaul/.rbenv/versions/2.7.6/lib/ruby/gems/2.7.0/gems/devise_token_auth-1.2.2/app/views"
  * "/home/markpaul/.rbenv/versions/2.7.6/lib/ruby/gems/2.7.0/gems/devise-4.9.2/app/views"

Did you mean?  layouts/mailer
               layouts/application
               devise/confirmations/new
               devise/registrations/new
               devise_token_auth/omniauth_external_window
               devise/sessions/new):
  
app/controllers/products_controller.rb:13:in `create'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/create_product" for 127.0.0.1 at 2023-09-28 15:56:11 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "color"=>"Blue", "category_id"=>1}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:7:in `create'
  [1m[36mCategory Load (0.5ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/products_controller.rb:7:in `create'
Completed 422 Unprocessable Entity in 55ms (Views: 0.2ms | ActiveRecord: 5.6ms | Allocations: 38855)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCategory Create (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Clothing"], ["description", "Ut porro autem rem."], ["created_at", "2023-09-28 13:19:00.548681"], ["updated_at", "2023-09-28 13:19:00.548681"]]
  [1m[36mTRANSACTION (1.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCategory Create (0.2ms)[0m  [1m[32mINSERT INTO "categories" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Baby"], ["description", "Quae expedita delectus architecto."], ["created_at", "2023-09-28 13:19:00.553383"], ["updated_at", "2023-09-28 13:19:00.553383"]]
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCategory Create (0.2ms)[0m  [1m[32mINSERT INTO "categories" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Movies"], ["description", "Quis quos impedit itaque."], ["created_at", "2023-09-28 13:19:00.556464"], ["updated_at", "2023-09-28 13:19:00.556464"]]
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCategory Create (0.2ms)[0m  [1m[32mINSERT INTO "categories" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Home"], ["description", "At sapiente autem est."], ["created_at", "2023-09-28 13:19:00.559598"], ["updated_at", "2023-09-28 13:19:00.559598"]]
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCategory Create (0.2ms)[0m  [1m[32mINSERT INTO "categories" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Grocery"], ["description", "Aperiam et nisi rerum."], ["created_at", "2023-09-28 13:19:00.562562"], ["updated_at", "2023-09-28 13:19:00.562562"]]
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCategory Create (0.2ms)[0m  [1m[32mINSERT INTO "categories" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Clothes"], ["description", "Clothing category"], ["created_at", "2023-09-28 13:19:00.565438"], ["updated_at", "2023-09-28 13:19:00.565438"]]
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCategory Create (0.2ms)[0m  [1m[32mINSERT INTO "categories" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Shoes"], ["description", "Footwear category"], ["created_at", "2023-09-28 13:19:00.568329"], ["updated_at", "2023-09-28 13:19:00.568329"]]
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCategory Create (0.1ms)[0m  [1m[32mINSERT INTO "categories" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Jewelry"], ["description", "Jewelry category"], ["created_at", "2023-09-28 13:19:00.571154"], ["updated_at", "2023-09-28 13:19:00.571154"]]
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mCOMMIT[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[36mCategory Load (0.5ms)[0m  [1m[34mSELECT "categories".* FROM "categories"[0m
Started POST "/create_product" for 127.0.0.1 at 2023-09-28 16:19:56 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "color"=>"Blue", "category_id"=>1}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:7:in `create'
  [1m[36mCategory Load (0.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:7:in `create'
  [1m[36mProduct Create (0.8ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["category_id", 1], ["created_at", "2023-09-28 13:19:56.383571"], ["updated_at", "2023-09-28 13:19:56.383571"]]
  ↳ app/controllers/products_controller.rb:7:in `create'
  [1m[36mTRANSACTION (8.4ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:7:in `create'
Completed 201 Created in 34ms (Views: 0.6ms | ActiveRecord: 13.7ms | Allocations: 11506)


Started POST "/create_product" for 127.0.0.1 at 2023-09-28 16:22:54 +0300
Error occurred while parsing request parameters.
Contents:

{
  "product": {
    "name": "New Product",
    "description": "A description of the new product",
    "price": 29.99,
    "size": "Medium",
    "brand":"LV"
    "color": "Blue",
    "category_id": 1
  }
}
Processing by ProductsController#create as */*
Completed 400 Bad Request in 0ms (ActiveRecord: 0.0ms | Allocations: 135)


  
ActionDispatch::Http::Parameters::ParseError (Error occurred while parsing request parameters):
  
app/controllers/products_controller.rb:19:in `product_params'
app/controllers/products_controller.rb:5:in `create'
Started POST "/create_product" for 127.0.0.1 at 2023-09-28 16:23:01 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
[31mUnpermitted parameter: :brand. Context: { controller: ProductsController, action: create, request: #<ActionDispatch::Request:0x00007f83cc011cb8>, params: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "brand"=>"LV", "color"=>"Blue", "category_id"=>1}, "controller"=>"products", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:7:in `create'
  [1m[36mCategory Load (0.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:7:in `create'
  [1m[36mProduct Create (0.3ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["category_id", 1], ["created_at", "2023-09-28 13:23:01.273960"], ["updated_at", "2023-09-28 13:23:01.273960"]]
  ↳ app/controllers/products_controller.rb:7:in `create'
  [1m[36mTRANSACTION (8.4ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:7:in `create'
Completed 201 Created in 14ms (Views: 0.5ms | ActiveRecord: 9.0ms | Allocations: 2952)


Started POST "/create_product" for 127.0.0.1 at 2023-09-28 16:24:36 +0300
  
SyntaxError (/home/markpaul/projects/skyva-api/app/controllers/products_controller.rb:19: syntax error, unexpected ':', expecting ')'
...:size,:brand, :stock_quantity :color, :category_id)
...                              ^
/home/markpaul/projects/skyva-api/app/controllers/products_controller.rb:19: syntax error, unexpected ')', expecting '.' or &. or :: or '['
..._quantity :color, :category_id)
...                              ^
):
  
app/controllers/products_controller.rb:19: syntax error, unexpected ':', expecting ')'
app/controllers/products_controller.rb:19: syntax error, unexpected ')', expecting '.' or &. or :: or '['
app/controllers/products_controller.rb:19: syntax error, unexpected ':', expecting ')'
app/controllers/products_controller.rb:19: syntax error, unexpected ')', expecting '.' or &. or :: or '['
Started POST "/create_product" for 127.0.0.1 at 2023-09-28 16:24:45 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:7:in `create'
  [1m[36mCategory Load (0.3ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:7:in `create'
  [1m[36mProduct Create (0.4ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["category_id", 1], ["created_at", "2023-09-28 13:24:45.811032"], ["updated_at", "2023-09-28 13:24:45.811032"]]
  ↳ app/controllers/products_controller.rb:7:in `create'
  [1m[36mTRANSACTION (8.5ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:7:in `create'
Completed 201 Created in 28ms (Views: 0.4ms | ActiveRecord: 14.8ms | Allocations: 9068)


Started POST "/create_product" for 127.0.0.1 at 2023-09-28 16:25:20 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:7:in `create'
  [1m[36mCategory Load (0.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:7:in `create'
  [1m[36mProduct Create (0.4ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-09-28 13:25:20.973240"], ["updated_at", "2023-09-28 13:25:20.973240"]]
  ↳ app/controllers/products_controller.rb:7:in `create'
  [1m[36mTRANSACTION (8.5ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:7:in `create'
Completed 201 Created in 14ms (Views: 0.4ms | ActiveRecord: 9.4ms | Allocations: 2895)


Started POST "/auth/sign_in" for 127.0.0.1 at 2023-09-28 16:26:05 +0300
Processing by DeviseTokenAuth::SessionsController#create as */*
  Parameters: {"email"=>"markpaulmuthaura@gmail.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 AND "users"."provider" = $2 LIMIT $3[0m  [["email", "markpaulmuthaura@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
Completed 401 Unauthorized in 6ms (Views: 0.2ms | ActiveRecord: 1.5ms | Allocations: 2983)


Started POST "/auth" for 127.0.0.1 at 2023-09-28 16:26:46 +0300
Processing by Auth::RegistrationsController#create as */*
  Parameters: {"email"=>"markpaulmuthuara2@gmail.com", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "markpaulmuthuara2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "email", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["encrypted_password", "[FILTERED]"], ["email", "markpaulmuthuara2@gmail.com"], ["created_at", "2023-09-28 13:26:47.232574"], ["updated_at", "2023-09-28 13:26:47.232574"]]
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mTRANSACTION (8.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mUser Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "users"[0m
  ↳ app/controllers/auth/registrations_controller.rb:9:in `block in create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/auth/registrations_controller.rb:10:in `block in create'
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "role" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2023-09-28 13:26:47.245066"], ["role", 1], ["id", 1]]
  ↳ app/controllers/auth/registrations_controller.rb:10:in `block in create'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/auth/registrations_controller.rb:10:in `block in create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "[FILTERED]"], ["updated_at", "2023-09-28 13:26:47.309963"], ["id", 1]]
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
Completed 200 OK in 332ms (Views: 0.2ms | ActiveRecord: 15.9ms | Allocations: 28934)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3422183495574815895)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(3422183495574815895)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-02 10:42:11 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>123, "quantity"=>2}
Completed 201 Created in 0ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 195)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[36mCart Load (8.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts"[0m
  [1m[36mCategory Load (8.5ms)[0m  [1m[34mSELECT "categories".* FROM "categories"[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (5017.7ms)[0m  [1m[35mDROP DATABASE IF EXISTS "skyva_api"[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[35m (0.2ms)[0m  [1m[35mCREATE DATABASE "skyva_api" ENCODING = 'unicode'[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE DATABASE "skyva_api" ENCODING = 'unicode'[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCategory Create (8.1ms)[0m  [1m[32mINSERT INTO "categories" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Clothes"], ["description", "Clothing category"], ["created_at", "2023-10-02 08:15:46.901613"], ["updated_at", "2023-10-02 08:15:46.901613"]]
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCategory Create (0.2ms)[0m  [1m[32mINSERT INTO "categories" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Shoes"], ["description", "Footwear category"], ["created_at", "2023-10-02 08:15:46.920843"], ["updated_at", "2023-10-02 08:15:46.920843"]]
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCategory Create (0.2ms)[0m  [1m[32mINSERT INTO "categories" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Jewelry"], ["description", "Jewelry category"], ["created_at", "2023-10-02 08:15:46.924147"], ["updated_at", "2023-10-02 08:15:46.924147"]]
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCategory Create (0.2ms)[0m  [1m[32mINSERT INTO "categories" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "men"], ["description", "mens clothing"], ["created_at", "2023-10-02 08:15:46.927264"], ["updated_at", "2023-10-02 08:15:46.927264"]]
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCategory Create (0.2ms)[0m  [1m[32mINSERT INTO "categories" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "women"], ["description", "women clothing"], ["created_at", "2023-10-02 08:15:46.930359"], ["updated_at", "2023-10-02 08:15:46.930359"]]
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mCOMMIT[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCategory Create (0.4ms)[0m  [1m[32mINSERT INTO "categories" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Clothes"], ["description", "Clothing category"], ["created_at", "2023-10-02 08:20:37.018451"], ["updated_at", "2023-10-02 08:20:37.018451"]]
  [1m[36mTRANSACTION (8.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCategory Create (0.3ms)[0m  [1m[32mINSERT INTO "categories" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Shoes"], ["description", "Footwear category"], ["created_at", "2023-10-02 08:20:37.029868"], ["updated_at", "2023-10-02 08:20:37.029868"]]
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCategory Create (0.2ms)[0m  [1m[32mINSERT INTO "categories" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Jewelry"], ["description", "Jewelry category"], ["created_at", "2023-10-02 08:20:37.033799"], ["updated_at", "2023-10-02 08:20:37.033799"]]
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCategory Create (0.2ms)[0m  [1m[32mINSERT INTO "categories" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Men"], ["description", "Men's clothing"], ["created_at", "2023-10-02 08:20:37.036972"], ["updated_at", "2023-10-02 08:20:37.036972"]]
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCategory Create (0.2ms)[0m  [1m[32mINSERT INTO "categories" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Women"], ["description", "Women's clothing"], ["created_at", "2023-10-02 08:20:37.040020"], ["updated_at", "2023-10-02 08:20:37.040020"]]
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mCOMMIT[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3422183495574815895)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateBrands (20231002082120)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (13.2ms)[0m  [1m[35mCREATE TABLE "brands" ("id" bigserial primary key, "name" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20231002082120"]]
  [1m[36mTRANSACTION (1.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[34mSELECT pg_advisory_unlock(3422183495574815895)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCategory Create (0.3ms)[0m  [1m[32mINSERT INTO "categories" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Clothes"], ["description", "Clothing category"], ["created_at", "2023-10-02 08:21:48.746845"], ["updated_at", "2023-10-02 08:21:48.746845"]]
  [1m[36mTRANSACTION (8.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCategory Create (0.2ms)[0m  [1m[32mINSERT INTO "categories" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Shoes"], ["description", "Footwear category"], ["created_at", "2023-10-02 08:21:48.757915"], ["updated_at", "2023-10-02 08:21:48.757915"]]
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCategory Create (0.2ms)[0m  [1m[32mINSERT INTO "categories" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Jewelry"], ["description", "Jewelry category"], ["created_at", "2023-10-02 08:21:48.761072"], ["updated_at", "2023-10-02 08:21:48.761072"]]
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCategory Create (0.1ms)[0m  [1m[32mINSERT INTO "categories" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Men"], ["description", "Men's clothing"], ["created_at", "2023-10-02 08:21:48.763954"], ["updated_at", "2023-10-02 08:21:48.763954"]]
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCategory Create (0.2ms)[0m  [1m[32mINSERT INTO "categories" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Women"], ["description", "Women's clothing"], ["created_at", "2023-10-02 08:21:48.766815"], ["updated_at", "2023-10-02 08:21:48.766815"]]
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBrand Create (0.5ms)[0m  [1m[32mINSERT INTO "brands" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Kirlin, Greenfelder and Kreiger"], ["description", "Reiciendis aut iste eos."], ["created_at", "2023-10-02 08:21:49.752101"], ["updated_at", "2023-10-02 08:21:49.752101"]]
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBrand Create (0.3ms)[0m  [1m[32mINSERT INTO "brands" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Mosciski, Harris and Fritsch"], ["description", "Repudiandae ut qui earum."], ["created_at", "2023-10-02 08:21:49.756496"], ["updated_at", "2023-10-02 08:21:49.756496"]]
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBrand Create (0.3ms)[0m  [1m[32mINSERT INTO "brands" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Torphy-Adams"], ["description", "Cum non enim reiciendis."], ["created_at", "2023-10-02 08:21:49.759941"], ["updated_at", "2023-10-02 08:21:49.759941"]]
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBrand Create (0.2ms)[0m  [1m[32mINSERT INTO "brands" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Turcotte-Schiller"], ["description", "Laudantium laboriosam est iusto."], ["created_at", "2023-10-02 08:21:49.763302"], ["updated_at", "2023-10-02 08:21:49.763302"]]
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBrand Create (0.2ms)[0m  [1m[32mINSERT INTO "brands" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Quitzon LLC"], ["description", "Ipsam aut tenetur omnis."], ["created_at", "2023-10-02 08:21:49.766549"], ["updated_at", "2023-10-02 08:21:49.766549"]]
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[35mCOMMIT[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[36mCategory Load (0.5ms)[0m  [1m[34mSELECT "categories".* FROM "categories"[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (25.4ms)[0m  [1m[35mDROP DATABASE IF EXISTS "skyva_api"[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP DATABASE IF EXISTS "skyva_api"[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[35m (107.2ms)[0m  [1m[35mCREATE DATABASE "skyva_api" ENCODING = 'unicode'[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE DATABASE "skyva_api" ENCODING = 'unicode'[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[35m (16.6ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[35m (8.6ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3422183495574815895)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to DeviseTokenAuthCreateUsers (20230819204134)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (8.2ms)[0m  [1m[35mCREATE TABLE "users" ("id" bigserial primary key, "provider" character varying DEFAULT 'email' NOT NULL, "uid" character varying DEFAULT '' NOT NULL, "encrypted_password" character varying DEFAULT '' NOT NULL, "reset_password_token" character varying, "reset_password_sent_at" timestamp(6), "allow_password_change" boolean DEFAULT FALSE, "remember_created_at" timestamp(6), "confirmation_token" character varying, "confirmed_at" timestamp(6), "confirmation_sent_at" timestamp(6), "unconfirmed_email" character varying, "name" character varying, "nickname" character varying, "image" character varying, "email" character varying, "tokens" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (4.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_users_on_email" ON "users" ("email")[0m
  [1m[35m (3.8ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_users_on_uid_and_provider" ON "users" ("uid", "provider")[0m
  [1m[35m (3.8ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_users_on_reset_password_token" ON "users" ("reset_password_token")[0m
  [1m[35m (3.9ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_users_on_confirmation_token" ON "users" ("confirmation_token")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20230819204134"]]
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mCOMMIT[0m
Migrating to AddRoleToUsers (20230821020342)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[35mALTER TABLE "users" ADD "role" integer[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20230821020342"]]
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreatePosts (20230821021958)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "posts" ("id" bigserial primary key, "title" character varying, "content" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20230821021958"]]
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateActiveStorageTables (20230821023831)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (8.3ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" bigserial primary key, "key" character varying NOT NULL, "filename" character varying NOT NULL, "content_type" character varying, "metadata" text, "service_name" character varying NOT NULL, "byte_size" bigint NOT NULL, "checksum" character varying, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (3.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (8.9ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" bigserial primary key, "name" character varying NOT NULL, "record_type" character varying NOT NULL, "record_id" bigint NOT NULL, "blob_id" bigint NOT NULL, "created_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_c3b3935057"
FOREIGN KEY ("blob_id")
  REFERENCES "active_storage_blobs" ("id")
)[0m
  [1m[35m (3.3ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (3.8ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (8.1ms)[0m  [1m[35mCREATE TABLE "active_storage_variant_records" ("id" bigserial primary key, "blob_id" bigint NOT NULL, "variation_digest" character varying NOT NULL, CONSTRAINT "fk_rails_993965df05"
FOREIGN KEY ("blob_id")
  REFERENCES "active_storage_blobs" ("id")
)[0m
  [1m[35m (3.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_variant_records_uniqueness" ON "active_storage_variant_records" ("blob_id", "variation_digest")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20230821023831"]]
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateProducts (20230928093423)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (16.4ms)[0m  [1m[35mCREATE TABLE "products" ("id" bigserial primary key, "name" character varying, "description" text, "price" decimal, "size" character varying, "color" character varying, "brand" character varying, "stock_quantity" integer, "category_id" bigint NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_fb915499a4"
FOREIGN KEY ("category_id")
  REFERENCES "categories" ("id")
)[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(3422183495574815895)[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3422183495574815895)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateCategories (20230928093441)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (9.6ms)[0m  [1m[35mCREATE TABLE "categories" ("id" bigserial primary key, "name" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20230928093441"]]
  [1m[36mTRANSACTION (1.4ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateOrders (20230928093450)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (8.2ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "user_id" bigint NOT NULL, "status" character varying, "total_amount" decimal, "shipping_address" text, "payment_details" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_f868b47f6a"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (3.3ms)[0m  [1m[35mCREATE INDEX "index_orders_on_user_id" ON "orders" ("user_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20230928093450"]]
  [1m[36mTRANSACTION (1.4ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateOrderItems (20230928093507)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (8.1ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" bigint NOT NULL, "product_id" bigint NOT NULL, "quantity" integer, "price" decimal, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_e3cb28f071"
FOREIGN KEY ("order_id")
  REFERENCES "orders" ("id")
, CONSTRAINT "fk_rails_f1a29ddd47"
FOREIGN KEY ("product_id")
  REFERENCES "products" ("id")
)[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT pg_advisory_unlock(3422183495574815895)[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3422183495574815895)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateProducts (20230928093423)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (8.6ms)[0m  [1m[35mCREATE TABLE "products" ("id" bigserial primary key, "name" character varying, "description" text, "price" decimal, "size" character varying, "color" character varying, "brand" character varying, "stock_quantity" integer, "category_id" bigint NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_fb915499a4"
FOREIGN KEY ("category_id")
  REFERENCES "categories" ("id")
)[0m
  [1m[35m (3.6ms)[0m  [1m[35mCREATE INDEX "index_products_on_category_id" ON "products" ("category_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.7ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20230928093423"]]
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateOrderItems (20230928093507)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (8.8ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" bigint NOT NULL, "product_id" bigint NOT NULL, "quantity" integer, "price" decimal, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_e3cb28f071"
FOREIGN KEY ("order_id")
  REFERENCES "orders" ("id")
, CONSTRAINT "fk_rails_f1a29ddd47"
FOREIGN KEY ("product_id")
  REFERENCES "products" ("id")
)[0m
  [1m[35m (3.5ms)[0m  [1m[35mCREATE INDEX "index_order_items_on_order_id" ON "order_items" ("order_id")[0m
  [1m[35m (3.8ms)[0m  [1m[35mCREATE INDEX "index_order_items_on_product_id" ON "order_items" ("product_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20230928093507"]]
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateCarts (20230928093648)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (4.2ms)[0m  [1m[35mCREATE TABLE "carts" ("id" bigserial primary key, "user_id" bigint NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_ea59a35211"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (3.6ms)[0m  [1m[35mCREATE INDEX "index_carts_on_user_id" ON "carts" ("user_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20230928093648"]]
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateAddresses (20230928093657)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (8.0ms)[0m  [1m[35mCREATE TABLE "addresses" ("id" bigserial primary key, "user_id" bigint NOT NULL, "address_type" character varying, "street" character varying, "city" character varying, "state" character varying, "postal_code" character varying, "country" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_48c9e0c5a2"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (3.8ms)[0m  [1m[35mCREATE INDEX "index_addresses_on_user_id" ON "addresses" ("user_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20230928093657"]]
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateReceipts (20230928094034)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (4.7ms)[0m  [1m[35mCREATE TABLE "receipts" ("id" bigserial primary key, "order_id" bigint NOT NULL, "user_id" bigint NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_de8c1572cc"
FOREIGN KEY ("order_id")
  REFERENCES "orders" ("id")
, CONSTRAINT "fk_rails_b2d4d3fa14"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (3.8ms)[0m  [1m[35mCREATE INDEX "index_receipts_on_order_id" ON "receipts" ("order_id")[0m
  [1m[35m (3.7ms)[0m  [1m[35mCREATE INDEX "index_receipts_on_user_id" ON "receipts" ("user_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20230928094034"]]
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateBrands (20231002082120)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (8.1ms)[0m  [1m[35mCREATE TABLE "brands" ("id" bigserial primary key, "name" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20231002082120"]]
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.4ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2023-10-02 08:49:05.210492"], ["updated_at", "2023-10-02 08:49:05.210492"]]
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(3422183495574815895)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCategory Create (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Clothes"], ["description", "Clothing category"], ["created_at", "2023-10-02 08:49:21.954607"], ["updated_at", "2023-10-02 08:49:21.954607"]]
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCategory Create (0.3ms)[0m  [1m[32mINSERT INTO "categories" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Shoes"], ["description", "Footwear category"], ["created_at", "2023-10-02 08:49:21.959237"], ["updated_at", "2023-10-02 08:49:21.959237"]]
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCategory Create (0.2ms)[0m  [1m[32mINSERT INTO "categories" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Jewelry"], ["description", "Jewelry category"], ["created_at", "2023-10-02 08:49:21.962589"], ["updated_at", "2023-10-02 08:49:21.962589"]]
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCategory Create (0.2ms)[0m  [1m[32mINSERT INTO "categories" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Men"], ["description", "Men's clothing"], ["created_at", "2023-10-02 08:49:21.965720"], ["updated_at", "2023-10-02 08:49:21.965720"]]
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCategory Create (0.2ms)[0m  [1m[32mINSERT INTO "categories" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Women"], ["description", "Women's clothing"], ["created_at", "2023-10-02 08:49:21.969128"], ["updated_at", "2023-10-02 08:49:21.969128"]]
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBrand Create (0.5ms)[0m  [1m[32mINSERT INTO "brands" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Balistreri LLC"], ["description", "Quam nesciunt quidem a."], ["created_at", "2023-10-02 08:49:22.952879"], ["updated_at", "2023-10-02 08:49:22.952879"]]
  [1m[36mTRANSACTION (8.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBrand Create (0.5ms)[0m  [1m[32mINSERT INTO "brands" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Kulas, Hahn and Schimmel"], ["description", "Quam est commodi cumque."], ["created_at", "2023-10-02 08:49:22.964296"], ["updated_at", "2023-10-02 08:49:22.964296"]]
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBrand Create (0.4ms)[0m  [1m[32mINSERT INTO "brands" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Sporer, Waelchi and Weber"], ["description", "Autem pariatur earum itaque."], ["created_at", "2023-10-02 08:49:22.968567"], ["updated_at", "2023-10-02 08:49:22.968567"]]
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBrand Create (0.3ms)[0m  [1m[32mINSERT INTO "brands" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Luettgen-Anderson"], ["description", "Id enim tenetur neque."], ["created_at", "2023-10-02 08:49:22.972648"], ["updated_at", "2023-10-02 08:49:22.972648"]]
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBrand Create (0.3ms)[0m  [1m[32mINSERT INTO "brands" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Lockman LLC"], ["description", "Possimus cupiditate vel nihil."], ["created_at", "2023-10-02 08:49:22.976689"], ["updated_at", "2023-10-02 08:49:22.976689"]]
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[35mCOMMIT[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[36mCategory Load (0.3ms)[0m  [1m[34mSELECT "categories".* FROM "categories"[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[36mBrand Load (0.2ms)[0m  [1m[34mSELECT "brands".* FROM "brands"[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-02 14:42:56 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>123, "quantity"=>2}
Completed 201 Created in 1ms (Views: 0.5ms | ActiveRecord: 0.0ms | Allocations: 195)


Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-02 15:03:04 +0300
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>123, "quantity"=>2}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 1086ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 720948)


Started POST "/auth" for 127.0.0.1 at 2023-10-02 15:09:45 +0300
Processing by Auth::RegistrationsController#create as */*
  Parameters: {"email"=>"markpaulmuthuara2@gmail.com", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "markpaulmuthuara2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "email", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["encrypted_password", "[FILTERED]"], ["email", "markpaulmuthuara2@gmail.com"], ["created_at", "2023-10-02 12:09:45.361342"], ["updated_at", "2023-10-02 12:09:45.361342"]]
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mTRANSACTION (8.8ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mUser Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "users"[0m
  ↳ app/controllers/auth/registrations_controller.rb:9:in `block in create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/auth/registrations_controller.rb:10:in `block in create'
  [1m[36mUser Update (0.8ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "role" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2023-10-02 12:09:45.374827"], ["role", 1], ["id", 1]]
  ↳ app/controllers/auth/registrations_controller.rb:10:in `block in create'
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/auth/registrations_controller.rb:10:in `block in create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "[FILTERED]"], ["updated_at", "2023-10-02 12:09:45.448535"], ["id", 1]]
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mTRANSACTION (5.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
Completed 200 OK in 373ms (Views: 0.2ms | ActiveRecord: 29.7ms | Allocations: 36030)


Started POST "/auth" for 127.0.0.1 at 2023-10-02 15:10:01 +0300
Processing by Auth::RegistrationsController#create as */*
  Parameters: {"email"=>"markpaulmuthuara3@gmail.com", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "markpaulmuthuara3@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "email", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["encrypted_password", "[FILTERED]"], ["email", "markpaulmuthuara3@gmail.com"], ["created_at", "2023-10-02 12:10:01.793426"], ["updated_at", "2023-10-02 12:10:01.793426"]]
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mUser Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "users"[0m
  ↳ app/controllers/auth/registrations_controller.rb:9:in `block in create'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "[FILTERED]"], ["updated_at", "2023-10-02 12:10:01.861658"], ["id", 2]]
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
Completed 200 OK in 324ms (Views: 0.2ms | ActiveRecord: 5.6ms | Allocations: 6157)


Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-02 15:10:27 +0300
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>123, "quantity"=>2}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 74ms (ActiveRecord: 0.5ms | Allocations: 5462)


  
NoMethodError (undefined method `cart' for #<User:0x00007f2cb5903920>):
  
app/controllers/carts_controller.rb:11:in `add_to_cart'
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-02 15:10:35 +0300
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 10ms (ActiveRecord: 0.2ms | Allocations: 5232)


  
NoMethodError (undefined method `cart' for #<User:0x00007f2cb53f3c78>):
  
app/controllers/carts_controller.rb:11:in `add_to_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-02 15:10:43 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 94ms (ActiveRecord: 4.4ms | Allocations: 29653)


  
NoMethodError (undefined method `cart' for #<User:0x00007fb9183bf7a8>):
  
app/controllers/carts_controller.rb:11:in `add_to_cart'
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-02 15:13:25 +0300
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.2ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:11:in `add_to_cart'
Completed 500 Internal Server Error in 108ms (ActiveRecord: 5.9ms | Allocations: 29067)


  
NoMethodError (undefined method `add_product' for #<Cart id: nil, user_id: 2, created_at: nil, updated_at: nil>):
  
app/controllers/carts_controller.rb:14:in `add_to_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-02 15:13:40 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.4ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:11:in `add_to_cart'
Completed 500 Internal Server Error in 123ms (ActiveRecord: 9.7ms | Allocations: 48191)


  
NoMethodError (undefined method `add_product' for #<Cart id: nil, user_id: 2, created_at: nil, updated_at: nil>):
  
app/controllers/carts_controller.rb:14:in `add_to_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-02 15:17:07 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:11:in `add_to_cart'
Completed 500 Internal Server Error in 115ms (ActiveRecord: 8.1ms | Allocations: 48186)


  
NoMethodError (undefined method `add_product' for #<Cart id: nil, user_id: 2, created_at: nil, updated_at: nil>):
  
app/controllers/carts_controller.rb:14:in `add_to_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-02 15:18:46 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.2ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:11:in `add_to_cart'
Completed 500 Internal Server Error in 116ms (ActiveRecord: 5.9ms | Allocations: 48533)


  
NameError (Rails couldn't find a valid model for CartItem association. Please provide the :class_name option on the association declaration. If :class_name is already provided, make sure it's an ActiveRecord::Base subclass.):
  
app/models/cart.rb:8:in `add_product'
app/controllers/carts_controller.rb:14:in `add_to_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-02 15:21:52 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.2ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:11:in `add_to_cart'
Completed 500 Internal Server Error in 114ms (ActiveRecord: 7.1ms | Allocations: 48513)


  
NameError (Rails couldn't find a valid model for CartItem association. Please provide the :class_name option on the association declaration. If :class_name is already provided, make sure it's an ActiveRecord::Base subclass.):
  
app/models/cart.rb:9:in `add_product'
app/controllers/carts_controller.rb:14:in `add_to_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-02 15:46:41 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.4ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:11:in `add_to_cart'
Completed 500 Internal Server Error in 124ms (ActiveRecord: 6.4ms | Allocations: 48196)


  
NoMethodError (undefined method `add_product' for #<Cart id: nil, user_id: 2, created_at: nil, updated_at: nil>):
  
app/controllers/carts_controller.rb:14:in `add_to_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-02 15:48:54 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.2ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:11:in `add_to_cart'
  [1m[36mProduct Load (0.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/cart.rb:15:in `add_product'
Completed 404 Not Found in 116ms (ActiveRecord: 9.2ms | Allocations: 51395)


  
ActiveRecord::RecordNotFound (Couldn't find Product with 'id'=1):
  
app/models/cart.rb:15:in `add_product'
app/controllers/carts_controller.rb:14:in `add_to_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT "products".* FROM "products"[0m
Started POST "/create_product" for 127.0.0.1 at 2023-10-02 15:49:47 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
Filter chain halted as :require_admin rendered or redirected
Completed 401 Unauthorized in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 215)


Started POST "/auth/sign_in" for 127.0.0.1 at 2023-10-02 15:51:34 +0300
Processing by DeviseTokenAuth::SessionsController#create as */*
  Parameters: {"email"=>"markpaulmuthaura@gmail.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 AND "users"."provider" = $2 LIMIT $3[0m  [["email", "markpaulmuthaura@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
Completed 401 Unauthorized in 1126ms (Views: 0.6ms | ActiveRecord: 0.4ms | Allocations: 722432)


Started POST "/auth/sign_in" for 127.0.0.1 at 2023-10-02 15:51:42 +0300
Processing by DeviseTokenAuth::SessionsController#create as */*
  Parameters: {"email"=>"markpaulmuthaura1@gmail.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 AND "users"."provider" = $2 LIMIT $3[0m  [["email", "markpaulmuthaura1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
Completed 401 Unauthorized in 3ms (Views: 0.2ms | ActiveRecord: 0.4ms | Allocations: 1014)


Started POST "/auth/sign_in" for 127.0.0.1 at 2023-10-02 15:52:01 +0300
Processing by DeviseTokenAuth::SessionsController#create as */*
  Parameters: {"email"=>"markpaulmuthaura2@gmail.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 AND "users"."provider" = $2 LIMIT $3[0m  [["email", "markpaulmuthaura2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
Completed 401 Unauthorized in 2ms (Views: 0.2ms | ActiveRecord: 0.3ms | Allocations: 1014)


Started GET "/auth/sign_in" for 127.0.0.1 at 2023-10-02 15:53:20 +0300
Processing by DeviseTokenAuth::SessionsController#new as */*
  Parameters: {"email"=>"markpaulmuthaura2@gmail.com", "password"=>"[FILTERED]"}
Completed 405 Method Not Allowed in 0ms (Views: 0.1ms | ActiveRecord: 0.0ms | Allocations: 114)


Started POST "/auth/sign_in" for 127.0.0.1 at 2023-10-02 15:53:25 +0300
Processing by DeviseTokenAuth::SessionsController#create as */*
  Parameters: {"email"=>"markpaulmuthaura2@gmail.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 AND "users"."provider" = $2 LIMIT $3[0m  [["email", "markpaulmuthaura2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
Completed 401 Unauthorized in 4ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 1000)


Started POST "/auth/sign_in" for 127.0.0.1 at 2023-10-02 15:53:31 +0300
Processing by DeviseTokenAuth::SessionsController#create as */*
  Parameters: {"email"=>"markpaulmuthaura3@gmail.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 AND "users"."provider" = $2 LIMIT $3[0m  [["email", "markpaulmuthaura3@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
Completed 401 Unauthorized in 3ms (Views: 0.2ms | ActiveRecord: 0.3ms | Allocations: 1000)


Started POST "/auth" for 127.0.0.1 at 2023-10-02 15:54:10 +0300
Processing by Auth::RegistrationsController#create as */*
  Parameters: {"email"=>"markpaulmuthuara3@gmail.com", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "markpaulmuthuara3@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
Completed 422 Unprocessable Entity in 232ms (Views: 0.3ms | ActiveRecord: 1.8ms | Allocations: 3941)


Started POST "/auth/sign_in" for 127.0.0.1 at 2023-10-02 15:54:25 +0300
Processing by DeviseTokenAuth::SessionsController#create as */*
  Parameters: {"email"=>"markpaulmuthuara2@gmail.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 AND "users"."provider" = $2 LIMIT $3[0m  [["email", "markpaulmuthuara2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Update (0.7ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "[FILTERED]"], ["updated_at", "2023-10-02 12:54:26.283800"], ["id", 1]]
  [1m[36mTRANSACTION (8.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 325ms (Views: 0.2ms | ActiveRecord: 10.8ms | Allocations: 7030)


Started POST "/create_product" for 127.0.0.1 at 2023-10-02 15:54:50 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.6ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-02 12:54:50.733425"], ["updated_at", "2023-10-02 12:54:50.733425"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (8.4ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 95ms (Views: 0.4ms | ActiveRecord: 12.1ms | Allocations: 22996)


Started POST "/create_product" for 127.0.0.1 at 2023-10-02 15:54:57 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.3ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.6ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-02 12:54:57.131296"], ["updated_at", "2023-10-02 12:54:57.131296"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (8.4ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 20ms (Views: 0.5ms | ActiveRecord: 10.4ms | Allocations: 4668)


Started POST "/create_product" for 127.0.0.1 at 2023-10-02 15:54:58 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.3ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.4ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-02 12:54:58.653861"], ["updated_at", "2023-10-02 12:54:58.653861"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (8.6ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 20ms (Views: 0.4ms | ActiveRecord: 10.5ms | Allocations: 4671)


Started POST "/create_product" for 127.0.0.1 at 2023-10-02 15:54:58 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.3ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.5ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-02 12:54:58.865746"], ["updated_at", "2023-10-02 12:54:58.865746"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (8.6ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 18ms (Views: 0.4ms | ActiveRecord: 10.1ms | Allocations: 4676)


Started POST "/create_product" for 127.0.0.1 at 2023-10-02 15:54:59 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.6ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-02 12:54:59.027394"], ["updated_at", "2023-10-02 12:54:59.027394"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 13ms (Views: 0.3ms | ActiveRecord: 3.2ms | Allocations: 4664)


Started POST "/create_product" for 127.0.0.1 at 2023-10-02 15:54:59 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.4ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.7ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-02 12:54:59.182791"], ["updated_at", "2023-10-02 12:54:59.182791"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (8.5ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 21ms (Views: 0.6ms | ActiveRecord: 10.5ms | Allocations: 4658)


Started POST "/create_product" for 127.0.0.1 at 2023-10-02 15:54:59 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.4ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-02 12:54:59.349684"], ["updated_at", "2023-10-02 12:54:59.349684"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (8.5ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 18ms (Views: 0.4ms | ActiveRecord: 9.8ms | Allocations: 4681)


Started POST "/create_product" for 127.0.0.1 at 2023-10-02 15:54:59 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.8ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-02 12:54:59.487332"], ["updated_at", "2023-10-02 12:54:59.487332"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (8.5ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 19ms (Views: 0.4ms | ActiveRecord: 9.9ms | Allocations: 4668)


Started POST "/create_product" for 127.0.0.1 at 2023-10-02 15:54:59 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.6ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-02 12:54:59.638410"], ["updated_at", "2023-10-02 12:54:59.638410"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (8.5ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 18ms (Views: 0.4ms | ActiveRecord: 9.8ms | Allocations: 4674)


Started POST "/create_product" for 127.0.0.1 at 2023-10-02 15:54:59 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.3ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.5ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-02 12:54:59.791045"], ["updated_at", "2023-10-02 12:54:59.791045"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (1.4ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 12ms (Views: 0.5ms | ActiveRecord: 3.0ms | Allocations: 4666)


Started POST "/create_product" for 127.0.0.1 at 2023-10-02 15:54:59 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.5ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.4ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-02 12:54:59.957028"], ["updated_at", "2023-10-02 12:54:59.957028"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (8.5ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 19ms (Views: 0.4ms | ActiveRecord: 10.2ms | Allocations: 4679)


Started POST "/create_product" for 127.0.0.1 at 2023-10-02 15:55:00 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.3ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.4ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-02 12:55:00.114091"], ["updated_at", "2023-10-02 12:55:00.114091"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (8.6ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 19ms (Views: 0.5ms | ActiveRecord: 10.0ms | Allocations: 4676)


Started POST "/create_product" for 127.0.0.1 at 2023-10-02 15:55:00 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.3ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.4ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-02 12:55:00.275649"], ["updated_at", "2023-10-02 12:55:00.275649"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (8.6ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 22ms (Views: 0.5ms | ActiveRecord: 10.2ms | Allocations: 4660)


Started POST "/create_product" for 127.0.0.1 at 2023-10-02 15:55:00 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.4ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-02 12:55:00.447708"], ["updated_at", "2023-10-02 12:55:00.447708"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (8.4ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 18ms (Views: 0.4ms | ActiveRecord: 9.9ms | Allocations: 4668)


Started POST "/create_product" for 127.0.0.1 at 2023-10-02 15:55:00 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.5ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-02 12:55:00.602983"], ["updated_at", "2023-10-02 12:55:00.602983"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (8.6ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 20ms (Views: 0.5ms | ActiveRecord: 10.2ms | Allocations: 4656)


Started POST "/create_product" for 127.0.0.1 at 2023-10-02 15:55:00 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.4ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-02 12:55:00.767481"], ["updated_at", "2023-10-02 12:55:00.767481"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 13ms (Views: 0.7ms | ActiveRecord: 2.7ms | Allocations: 4668)


Started POST "/create_product" for 127.0.0.1 at 2023-10-02 15:55:00 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.5ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-02 12:55:00.931251"], ["updated_at", "2023-10-02 12:55:00.931251"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (8.5ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 19ms (Views: 0.5ms | ActiveRecord: 10.1ms | Allocations: 4670)


Started POST "/create_product" for 127.0.0.1 at 2023-10-02 15:55:01 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.7ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-02 12:55:01.102366"], ["updated_at", "2023-10-02 12:55:01.102366"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (8.9ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 19ms (Views: 0.3ms | ActiveRecord: 10.3ms | Allocations: 4664)


Started POST "/create_product" for 127.0.0.1 at 2023-10-02 15:55:01 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.6ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-02 12:55:01.303353"], ["updated_at", "2023-10-02 12:55:01.303353"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (8.5ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 20ms (Views: 0.6ms | ActiveRecord: 10.0ms | Allocations: 4665)


Started POST "/create_product" for 127.0.0.1 at 2023-10-02 15:55:01 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.6ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-02 12:55:01.477823"], ["updated_at", "2023-10-02 12:55:01.477823"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 13ms (Views: 0.3ms | ActiveRecord: 2.6ms | Allocations: 4668)


Started POST "/create_product" for 127.0.0.1 at 2023-10-02 15:55:01 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.4ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-02 12:55:01.627958"], ["updated_at", "2023-10-02 12:55:01.627958"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 11ms (Views: 0.4ms | ActiveRecord: 2.5ms | Allocations: 4664)


Started POST "/create_product" for 127.0.0.1 at 2023-10-02 15:55:01 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.6ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-02 12:55:01.795609"], ["updated_at", "2023-10-02 12:55:01.795609"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 11ms (Views: 0.3ms | ActiveRecord: 2.5ms | Allocations: 4662)


Started POST "/create_product" for 127.0.0.1 at 2023-10-02 15:55:02 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.4ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.6ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-02 12:55:02.369472"], ["updated_at", "2023-10-02 12:55:02.369472"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 16ms (Views: 0.4ms | ActiveRecord: 3.2ms | Allocations: 4658)


Started POST "/create_product" for 127.0.0.1 at 2023-10-02 15:55:02 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.3ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.5ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-02 12:55:02.633818"], ["updated_at", "2023-10-02 12:55:02.633818"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (8.6ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 20ms (Views: 0.4ms | ActiveRecord: 10.1ms | Allocations: 4666)


Started POST "/create_product" for 127.0.0.1 at 2023-10-02 15:55:02 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.4ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-02 12:55:02.989601"], ["updated_at", "2023-10-02 12:55:02.989601"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (8.7ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 28ms (Views: 0.4ms | ActiveRecord: 10.1ms | Allocations: 4668)


Started POST "/create_product" for 127.0.0.1 at 2023-10-02 15:55:03 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.5ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-02 12:55:03.590272"], ["updated_at", "2023-10-02 12:55:03.590272"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (8.6ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 20ms (Views: 0.5ms | ActiveRecord: 10.0ms | Allocations: 4661)


Started POST "/create_product" for 127.0.0.1 at 2023-10-02 15:55:04 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.3ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-02 12:55:04.125702"], ["updated_at", "2023-10-02 12:55:04.125702"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (8.5ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 19ms (Views: 0.3ms | ActiveRecord: 9.6ms | Allocations: 4678)


Started POST "/create_product" for 127.0.0.1 at 2023-10-02 15:55:04 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.4ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-02 12:55:04.754213"], ["updated_at", "2023-10-02 12:55:04.754213"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (8.9ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 19ms (Views: 0.5ms | ActiveRecord: 10.3ms | Allocations: 4672)


Started POST "/create_product" for 127.0.0.1 at 2023-10-02 15:55:05 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.7ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-02 12:55:05.307754"], ["updated_at", "2023-10-02 12:55:05.307754"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (8.5ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 19ms (Views: 0.4ms | ActiveRecord: 10.1ms | Allocations: 4673)


Started POST "/create_product" for 127.0.0.1 at 2023-10-02 15:55:05 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.3ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.4ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-02 12:55:05.931862"], ["updated_at", "2023-10-02 12:55:05.931862"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (8.4ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 23ms (Views: 0.5ms | ActiveRecord: 10.2ms | Allocations: 4660)


Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-02 15:55:25 +0300
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:11:in `add_to_cart'
  [1m[36mProduct Load (0.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/cart.rb:15:in `add_product'
Completed 500 Internal Server Error in 9ms (ActiveRecord: 0.8ms | Allocations: 4467)


  
NameError (Rails couldn't find a valid model for CartItem association. Please provide the :class_name option on the association declaration. If :class_name is already provided, make sure it's an ActiveRecord::Base subclass.):
  
app/models/cart.rb:18:in `add_product'
app/controllers/carts_controller.rb:14:in `add_to_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-02 15:56:30 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.2ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:11:in `add_to_cart'
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/cart.rb:15:in `add_product'
Completed 500 Internal Server Error in 125ms (ActiveRecord: 9.4ms | Allocations: 68934)


  
NameError (Rails couldn't find a valid model for CartItem association. Please provide the :class_name option on the association declaration. If :class_name is already provided, make sure it's an ActiveRecord::Base subclass.):
  
app/models/cart.rb:18:in `add_product'
app/controllers/carts_controller.rb:14:in `add_to_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-02 15:57:31 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:11:in `add_to_cart'
  [1m[36mProduct Load (0.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/cart.rb:15:in `add_product'
Completed 422 Unprocessable Entity in 146ms (ActiveRecord: 12.0ms | Allocations: 72275)


  
ActiveRecord::RecordNotSaved (You cannot call create unless the parent is saved):
  
app/models/cart.rb:25:in `add_product'
app/controllers/carts_controller.rb:14:in `add_to_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-02 15:59:06 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:11:in `add_to_cart'
  [1m[36mProduct Load (0.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/cart.rb:15:in `add_product'
Completed 500 Internal Server Error in 136ms (ActiveRecord: 10.6ms | Allocations: 86352)


  
ActiveModel::UnknownAttributeError (unknown attribute 'cart_id' for OrderItem.):
  
app/models/cart.rb:25:in `add_product'
app/controllers/carts_controller.rb:14:in `add_to_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-02 16:00:14 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:11:in `add_to_cart'
  [1m[36mProduct Load (0.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/cart.rb:15:in `add_product'
Completed 500 Internal Server Error in 137ms (ActiveRecord: 12.3ms | Allocations: 87517)


  
ActiveModel::UnknownAttributeError (unknown attribute 'cart_id' for OrderItem.):
  
app/models/cart.rb:25:in `add_product'
app/controllers/carts_controller.rb:14:in `add_to_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-02 16:01:20 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
  
AbstractController::ActionNotFound (The action 'add_to_cart' could not be found for CartsController
Did you mean?  add_product):
  
actionpack (7.0.7) lib/abstract_controller/base.rb:146:in `process'
actionview (7.0.7) lib/action_view/rendering.rb:39:in `process'
actionpack (7.0.7) lib/action_controller/metal.rb:188:in `dispatch'
actionpack (7.0.7) lib/action_controller/metal.rb:251:in `dispatch'
actionpack (7.0.7) lib/action_dispatch/routing/route_set.rb:49:in `dispatch'
actionpack (7.0.7) lib/action_dispatch/routing/route_set.rb:32:in `serve'
actionpack (7.0.7) lib/action_dispatch/journey/router.rb:50:in `block in serve'
actionpack (7.0.7) lib/action_dispatch/journey/router.rb:32:in `each'
actionpack (7.0.7) lib/action_dispatch/journey/router.rb:32:in `serve'
actionpack (7.0.7) lib/action_dispatch/routing/route_set.rb:852:in `call'
rack (2.2.8) lib/rack/session/abstract/id.rb:266:in `context'
rack (2.2.8) lib/rack/session/abstract/id.rb:260:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/cookies.rb:704:in `call'
warden (1.2.9) lib/warden/manager.rb:36:in `block in call'
warden (1.2.9) lib/warden/manager.rb:34:in `catch'
warden (1.2.9) lib/warden/manager.rb:34:in `call'
rack (2.2.8) lib/rack/etag.rb:27:in `call'
rack (2.2.8) lib/rack/conditional_get.rb:40:in `call'
rack (2.2.8) lib/rack/head.rb:12:in `call'
activerecord (7.0.7) lib/active_record/migration.rb:603:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
activesupport (7.0.7) lib/active_support/callbacks.rb:99:in `run_callbacks'
actionpack (7.0.7) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/actionable_exceptions.rb:17:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/debug_exceptions.rb:28:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/show_exceptions.rb:29:in `call'
railties (7.0.7) lib/rails/rack/logger.rb:40:in `call_app'
railties (7.0.7) lib/rails/rack/logger.rb:25:in `block in call'
activesupport (7.0.7) lib/active_support/tagged_logging.rb:99:in `block in tagged'
activesupport (7.0.7) lib/active_support/tagged_logging.rb:37:in `tagged'
activesupport (7.0.7) lib/active_support/tagged_logging.rb:99:in `tagged'
railties (7.0.7) lib/rails/rack/logger.rb:25:in `call'
sprockets-rails (3.4.2) lib/sprockets/rails/quiet_assets.rb:13:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/remote_ip.rb:93:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/request_id.rb:26:in `call'
rack (2.2.8) lib/rack/runtime.rb:22:in `call'
activesupport (7.0.7) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.0.7) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.0.7) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/static.rb:23:in `call'
rack (2.2.8) lib/rack/sendfile.rb:110:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/host_authorization.rb:137:in `call'
rack-cors (2.0.1) lib/rack/cors.rb:102:in `call'
railties (7.0.7) lib/rails/engine.rb:530:in `call'
puma (5.6.7) lib/puma/configuration.rb:252:in `call'
puma (5.6.7) lib/puma/request.rb:77:in `block in handle_request'
puma (5.6.7) lib/puma/thread_pool.rb:340:in `with_force_shutdown'
puma (5.6.7) lib/puma/request.rb:76:in `handle_request'
puma (5.6.7) lib/puma/server.rb:443:in `process_client'
puma (5.6.7) lib/puma/thread_pool.rb:147:in `block in spawn_thread'
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-02 16:01:33 +0300
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:11:in `add_to_cart'
  [1m[36mProduct Load (0.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/cart.rb:16:in `add_product'
Completed 500 Internal Server Error in 137ms (ActiveRecord: 11.3ms | Allocations: 87547)


  
ActiveModel::UnknownAttributeError (unknown attribute 'cart_id' for OrderItem.):
  
app/models/cart.rb:26:in `add_product'
app/controllers/carts_controller.rb:14:in `add_to_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3422183495574815895)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to AddCartReferenceToOrderItems (20231002130233)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[35mALTER TABLE "order_items" ADD "cart_id" bigint NOT NULL[0m
  [1m[35m (11.4ms)[0m  [1m[35mCREATE INDEX "index_order_items_on_cart_id" ON "order_items" ("cart_id")[0m
  [1m[35m (1.2ms)[0m  [1m[35mALTER TABLE "order_items" ADD CONSTRAINT "fk_rails_59f7f23852"
FOREIGN KEY ("cart_id")
  REFERENCES "carts" ("id")
[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20231002130233"]]
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(3422183495574815895)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-02 16:02:56 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.2ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:11:in `add_to_cart'
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/cart.rb:16:in `add_product'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 1258ms (Views: 0.2ms | ActiveRecord: 12.0ms | Allocations: 812363)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-02 16:06:53 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 92ms (ActiveRecord: 4.4ms | Allocations: 27636)


  
SyntaxError (/home/markpaul/projects/skyva-api/app/models/cart.rb:32: else without rescue is useless
    else
    ^~~~
/home/markpaul/projects/skyva-api/app/models/cart.rb:43: syntax error, unexpected `end', expecting end-of-input):
  
app/models/cart.rb:32: else without rescue is useless
app/models/cart.rb:43: syntax error, unexpected `end', expecting end-of-input
app/models/cart.rb:32: else without rescue is useless
app/models/cart.rb:43: syntax error, unexpected `end', expecting end-of-input
app/controllers/carts_controller.rb:11:in `add_to_cart'
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-02 16:07:36 +0300
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 74ms (ActiveRecord: 3.4ms | Allocations: 6562)


  
SyntaxError (/home/markpaul/projects/skyva-api/app/models/cart.rb:32: else without rescue is useless
    else
    ^~~~
/home/markpaul/projects/skyva-api/app/models/cart.rb:43: syntax error, unexpected `end', expecting end-of-input):
  
app/models/cart.rb:32: else without rescue is useless
app/models/cart.rb:43: syntax error, unexpected `end', expecting end-of-input
app/models/cart.rb:32: else without rescue is useless
app/models/cart.rb:43: syntax error, unexpected `end', expecting end-of-input
app/controllers/carts_controller.rb:11:in `add_to_cart'
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-02 16:07:49 +0300
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 77ms (ActiveRecord: 2.6ms | Allocations: 12080)


  
NameError (Rails couldn't find a valid model for Cart association. Please provide the :class_name option on the association declaration. If :class_name is already provided, make sure it's an ActiveRecord::Base subclass.):
  
app/controllers/carts_controller.rb:11:in `add_to_cart'
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-02 16:07:59 +0300
  
AbstractController::ActionNotFound (The action 'add_to_cart' could not be found for CartsController):
  
actionpack (7.0.7) lib/abstract_controller/base.rb:146:in `process'
actionview (7.0.7) lib/action_view/rendering.rb:39:in `process'
actionpack (7.0.7) lib/action_controller/metal.rb:188:in `dispatch'
actionpack (7.0.7) lib/action_controller/metal.rb:251:in `dispatch'
actionpack (7.0.7) lib/action_dispatch/routing/route_set.rb:49:in `dispatch'
actionpack (7.0.7) lib/action_dispatch/routing/route_set.rb:32:in `serve'
actionpack (7.0.7) lib/action_dispatch/journey/router.rb:50:in `block in serve'
actionpack (7.0.7) lib/action_dispatch/journey/router.rb:32:in `each'
actionpack (7.0.7) lib/action_dispatch/journey/router.rb:32:in `serve'
actionpack (7.0.7) lib/action_dispatch/routing/route_set.rb:852:in `call'
rack (2.2.8) lib/rack/session/abstract/id.rb:266:in `context'
rack (2.2.8) lib/rack/session/abstract/id.rb:260:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/cookies.rb:704:in `call'
warden (1.2.9) lib/warden/manager.rb:36:in `block in call'
warden (1.2.9) lib/warden/manager.rb:34:in `catch'
warden (1.2.9) lib/warden/manager.rb:34:in `call'
rack (2.2.8) lib/rack/etag.rb:27:in `call'
rack (2.2.8) lib/rack/conditional_get.rb:40:in `call'
rack (2.2.8) lib/rack/head.rb:12:in `call'
activerecord (7.0.7) lib/active_record/migration.rb:603:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
activesupport (7.0.7) lib/active_support/callbacks.rb:99:in `run_callbacks'
actionpack (7.0.7) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/actionable_exceptions.rb:17:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/debug_exceptions.rb:28:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/show_exceptions.rb:29:in `call'
railties (7.0.7) lib/rails/rack/logger.rb:40:in `call_app'
railties (7.0.7) lib/rails/rack/logger.rb:25:in `block in call'
activesupport (7.0.7) lib/active_support/tagged_logging.rb:99:in `block in tagged'
activesupport (7.0.7) lib/active_support/tagged_logging.rb:37:in `tagged'
activesupport (7.0.7) lib/active_support/tagged_logging.rb:99:in `tagged'
railties (7.0.7) lib/rails/rack/logger.rb:25:in `call'
sprockets-rails (3.4.2) lib/sprockets/rails/quiet_assets.rb:13:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/remote_ip.rb:93:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/request_id.rb:26:in `call'
rack (2.2.8) lib/rack/runtime.rb:22:in `call'
activesupport (7.0.7) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.0.7) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.0.7) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/static.rb:23:in `call'
rack (2.2.8) lib/rack/sendfile.rb:110:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/host_authorization.rb:137:in `call'
rack-cors (2.0.1) lib/rack/cors.rb:102:in `call'
railties (7.0.7) lib/rails/engine.rb:530:in `call'
puma (5.6.7) lib/puma/configuration.rb:252:in `call'
puma (5.6.7) lib/puma/request.rb:77:in `block in handle_request'
puma (5.6.7) lib/puma/thread_pool.rb:340:in `with_force_shutdown'
puma (5.6.7) lib/puma/request.rb:76:in `handle_request'
puma (5.6.7) lib/puma/server.rb:443:in `process_client'
puma (5.6.7) lib/puma/thread_pool.rb:147:in `block in spawn_thread'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-02 16:12:14 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
  
AbstractController::ActionNotFound (The action 'add_to_cart' could not be found for CartsController):
  
actionpack (7.0.7) lib/abstract_controller/base.rb:146:in `process'
actionview (7.0.7) lib/action_view/rendering.rb:39:in `process'
actionpack (7.0.7) lib/action_controller/metal.rb:188:in `dispatch'
actionpack (7.0.7) lib/action_controller/metal.rb:251:in `dispatch'
actionpack (7.0.7) lib/action_dispatch/routing/route_set.rb:49:in `dispatch'
actionpack (7.0.7) lib/action_dispatch/routing/route_set.rb:32:in `serve'
actionpack (7.0.7) lib/action_dispatch/journey/router.rb:50:in `block in serve'
actionpack (7.0.7) lib/action_dispatch/journey/router.rb:32:in `each'
actionpack (7.0.7) lib/action_dispatch/journey/router.rb:32:in `serve'
actionpack (7.0.7) lib/action_dispatch/routing/route_set.rb:852:in `call'
rack (2.2.8) lib/rack/session/abstract/id.rb:266:in `context'
rack (2.2.8) lib/rack/session/abstract/id.rb:260:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/cookies.rb:704:in `call'
warden (1.2.9) lib/warden/manager.rb:36:in `block in call'
warden (1.2.9) lib/warden/manager.rb:34:in `catch'
warden (1.2.9) lib/warden/manager.rb:34:in `call'
rack (2.2.8) lib/rack/etag.rb:27:in `call'
rack (2.2.8) lib/rack/conditional_get.rb:40:in `call'
rack (2.2.8) lib/rack/head.rb:12:in `call'
activerecord (7.0.7) lib/active_record/migration.rb:603:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
activesupport (7.0.7) lib/active_support/callbacks.rb:99:in `run_callbacks'
actionpack (7.0.7) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/actionable_exceptions.rb:17:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/debug_exceptions.rb:28:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/show_exceptions.rb:29:in `call'
railties (7.0.7) lib/rails/rack/logger.rb:40:in `call_app'
railties (7.0.7) lib/rails/rack/logger.rb:25:in `block in call'
activesupport (7.0.7) lib/active_support/tagged_logging.rb:99:in `block in tagged'
activesupport (7.0.7) lib/active_support/tagged_logging.rb:37:in `tagged'
activesupport (7.0.7) lib/active_support/tagged_logging.rb:99:in `tagged'
railties (7.0.7) lib/rails/rack/logger.rb:25:in `call'
sprockets-rails (3.4.2) lib/sprockets/rails/quiet_assets.rb:13:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/remote_ip.rb:93:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/request_id.rb:26:in `call'
rack (2.2.8) lib/rack/runtime.rb:22:in `call'
activesupport (7.0.7) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.0.7) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.0.7) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/static.rb:23:in `call'
rack (2.2.8) lib/rack/sendfile.rb:110:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/host_authorization.rb:137:in `call'
rack-cors (2.0.1) lib/rack/cors.rb:102:in `call'
railties (7.0.7) lib/rails/engine.rb:530:in `call'
puma (5.6.7) lib/puma/configuration.rb:252:in `call'
puma (5.6.7) lib/puma/request.rb:77:in `block in handle_request'
puma (5.6.7) lib/puma/thread_pool.rb:340:in `with_force_shutdown'
puma (5.6.7) lib/puma/request.rb:76:in `handle_request'
puma (5.6.7) lib/puma/server.rb:443:in `process_client'
puma (5.6.7) lib/puma/thread_pool.rb:147:in `block in spawn_thread'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-02 16:16:13 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
No template found for CartsController#add_to_cart, rendering head :no_content
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 204 No Content in 95ms (ActiveRecord: 5.0ms | Allocations: 27076)


Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-02 16:17:05 +0300
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 79ms (ActiveRecord: 3.7ms | Allocations: 9731)


  
NameError (undefined local variable or method `cart' for #<CartsController:0x00000000010180>):
  
app/controllers/carts_controller.rb:10:in `add_to_cart'
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-02 16:17:57 +0300
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
No template found for CartsController#add_to_cart, rendering head :no_content
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 204 No Content in 76ms (ActiveRecord: 3.6ms | Allocations: 7645)


Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-02 16:19:31 +0300
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
No template found for CartsController#add_to_cart, rendering head :no_content
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 204 No Content in 76ms (ActiveRecord: 3.6ms | Allocations: 7406)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-02 16:20:54 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.6ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:9:in `add_to_cart'
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/cart.rb:15:in `add_product'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 1274ms (Views: 0.3ms | ActiveRecord: 13.5ms | Allocations: 812369)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-02 16:22:25 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.2ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:9:in `add_to_cart'
  [1m[36mProduct Load (0.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/cart.rb:15:in `add_product'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 1310ms (Views: 0.4ms | ActiveRecord: 13.4ms | Allocations: 812356)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[36mCart Load (0.7ms)[0m  [1m[34mSELECT "carts".* FROM "carts"[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/create_product" for 127.0.0.1 at 2023-10-03 11:04:13 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (1.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.5ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (1.6ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-03 08:04:14.136898"], ["updated_at", "2023-10-03 08:04:14.136898"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (1.6ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 131ms (Views: 0.5ms | ActiveRecord: 15.2ms | Allocations: 54775)


Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-03 11:04:35 +0300
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.5ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:9:in `add_to_cart'
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/cart.rb:15:in `add_product'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 1236ms (Views: 0.2ms | ActiveRecord: 5.4ms | Allocations: 764359)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-03 11:04:52 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.2ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:9:in `add_to_cart'
  [1m[36mProduct Load (0.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/cart.rb:15:in `add_product'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 1359ms (Views: 0.3ms | ActiveRecord: 12.5ms | Allocations: 812376)


Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-03 11:29:51 +0300
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.2ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:9:in `add_to_cart'
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/cart.rb:15:in `add_product'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 107ms (Views: 0.2ms | ActiveRecord: 7.1ms | Allocations: 29081)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/auth/sign_in" for 127.0.0.1 at 2023-10-03 12:09:26 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by DeviseTokenAuth::SessionsController#create as */*
  Parameters: {"email"=>"markpaulmuthuara2@gmail.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 AND "users"."provider" = $2 LIMIT $3[0m  [["email", "markpaulmuthuara2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Update (0.9ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "[FILTERED]"], ["updated_at", "2023-10-03 09:09:27.419464"], ["id", 1]]
  [1m[36mTRANSACTION (4.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 349ms (Views: 0.2ms | ActiveRecord: 13.7ms | Allocations: 33053)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-03 12:09:57 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.7ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:9:in `add_to_cart'
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/cart.rb:15:in `add_product'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 1253ms (Views: 0.2ms | ActiveRecord: 15.4ms | Allocations: 812372)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-03 12:12:54 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.2ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:9:in `add_to_cart'
  [1m[36mProduct Load (0.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/cart.rb:15:in `add_product'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 1206ms (Views: 0.2ms | ActiveRecord: 9.7ms | Allocations: 812374)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-03 12:14:06 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.2ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:9:in `add_to_cart'
  [1m[36mProduct Load (0.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/cart.rb:15:in `add_product'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 1189ms (Views: 0.3ms | ActiveRecord: 10.3ms | Allocations: 812363)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-03 12:15:50 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
  
AbstractController::ActionNotFound (The action 'add_to_cart' could not be found for CartsController):
  
actionpack (7.0.7) lib/abstract_controller/base.rb:146:in `process'
actionview (7.0.7) lib/action_view/rendering.rb:39:in `process'
actionpack (7.0.7) lib/action_controller/metal.rb:188:in `dispatch'
actionpack (7.0.7) lib/action_controller/metal.rb:251:in `dispatch'
actionpack (7.0.7) lib/action_dispatch/routing/route_set.rb:49:in `dispatch'
actionpack (7.0.7) lib/action_dispatch/routing/route_set.rb:32:in `serve'
actionpack (7.0.7) lib/action_dispatch/journey/router.rb:50:in `block in serve'
actionpack (7.0.7) lib/action_dispatch/journey/router.rb:32:in `each'
actionpack (7.0.7) lib/action_dispatch/journey/router.rb:32:in `serve'
actionpack (7.0.7) lib/action_dispatch/routing/route_set.rb:852:in `call'
rack (2.2.8) lib/rack/session/abstract/id.rb:266:in `context'
rack (2.2.8) lib/rack/session/abstract/id.rb:260:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/cookies.rb:704:in `call'
warden (1.2.9) lib/warden/manager.rb:36:in `block in call'
warden (1.2.9) lib/warden/manager.rb:34:in `catch'
warden (1.2.9) lib/warden/manager.rb:34:in `call'
rack (2.2.8) lib/rack/etag.rb:27:in `call'
rack (2.2.8) lib/rack/conditional_get.rb:40:in `call'
rack (2.2.8) lib/rack/head.rb:12:in `call'
activerecord (7.0.7) lib/active_record/migration.rb:603:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
activesupport (7.0.7) lib/active_support/callbacks.rb:99:in `run_callbacks'
actionpack (7.0.7) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/actionable_exceptions.rb:17:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/debug_exceptions.rb:28:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/show_exceptions.rb:29:in `call'
railties (7.0.7) lib/rails/rack/logger.rb:40:in `call_app'
railties (7.0.7) lib/rails/rack/logger.rb:25:in `block in call'
activesupport (7.0.7) lib/active_support/tagged_logging.rb:99:in `block in tagged'
activesupport (7.0.7) lib/active_support/tagged_logging.rb:37:in `tagged'
activesupport (7.0.7) lib/active_support/tagged_logging.rb:99:in `tagged'
railties (7.0.7) lib/rails/rack/logger.rb:25:in `call'
sprockets-rails (3.4.2) lib/sprockets/rails/quiet_assets.rb:13:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/remote_ip.rb:93:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/request_id.rb:26:in `call'
rack (2.2.8) lib/rack/runtime.rb:22:in `call'
activesupport (7.0.7) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.0.7) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.0.7) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/static.rb:23:in `call'
rack (2.2.8) lib/rack/sendfile.rb:110:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/host_authorization.rb:137:in `call'
rack-cors (2.0.1) lib/rack/cors.rb:102:in `call'
railties (7.0.7) lib/rails/engine.rb:530:in `call'
puma (5.6.7) lib/puma/configuration.rb:252:in `call'
puma (5.6.7) lib/puma/request.rb:77:in `block in handle_request'
puma (5.6.7) lib/puma/thread_pool.rb:340:in `with_force_shutdown'
puma (5.6.7) lib/puma/request.rb:76:in `handle_request'
puma (5.6.7) lib/puma/server.rb:443:in `process_client'
puma (5.6.7) lib/puma/thread_pool.rb:147:in `block in spawn_thread'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-03 12:16:28 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.2ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:9:in `add_to_cart'
Completed 500 Internal Server Error in 104ms (ActiveRecord: 5.0ms | Allocations: 47773)


  
NoMethodError (undefined method `add_product' for #<Cart id: nil, user_id: 2, created_at: nil, updated_at: nil>):
  
app/controllers/carts_controller.rb:12:in `add_to_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-03 12:17:04 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
No template found for CartsController#add_to_cart, rendering head :no_content
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 204 No Content in 97ms (ActiveRecord: 4.4ms | Allocations: 27078)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-03 12:39:17 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2}
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
No template found for CartsController#add_to_cart, rendering head :no_content
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 204 No Content in 89ms (ActiveRecord: 6.1ms | Allocations: 27084)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from block (3 levels) in <class:Railtie> at /home/markpaul/.rbenv/versions/2.7.6/lib/ruby/gems/2.7.0/gems/actionpack-7.0.7/lib/action_controller/railtie.rb:80)
Started GET "/cart" for 127.0.0.1 at 2023-10-04 10:50:52 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
ActionController::RoutingError (No route matches [GET] "/cart"):
  
Started GET "/cart" for 127.0.0.1 at 2023-10-04 10:51:43 +0300
  
ActionController::RoutingError (No route matches [GET] "/cart"):
  
Started GET "/cart" for 127.0.0.1 at 2023-10-04 10:52:19 +0300
  
ActionController::RoutingError (No route matches [GET] "/cart"):
  
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from block (3 levels) in <class:Railtie> at /home/markpaul/.rbenv/versions/2.7.6/lib/ruby/gems/2.7.0/gems/actionpack-7.0.7/lib/action_controller/railtie.rb:80)
Started GET "/cart" for 127.0.0.1 at 2023-10-04 10:52:27 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
ActionController::RoutingError (No route matches [GET] "/cart"):
  
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from block (3 levels) in <class:Railtie> at /home/markpaul/.rbenv/versions/2.7.6/lib/ruby/gems/2.7.0/gems/actionpack-7.0.7/lib/action_controller/railtie.rb:80)
Started GET "/cart" for 127.0.0.1 at 2023-10-04 10:54:45 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
ActionController::RoutingError (No route matches [GET] "/cart"):
  
Started GET "/carts/1/get_cart" for 127.0.0.1 at 2023-10-04 10:55:21 +0300
  
AbstractController::ActionNotFound (The action 'get_cart' could not be found for CartsController):
  
actionpack (7.0.7) lib/abstract_controller/base.rb:146:in `process'
actionview (7.0.7) lib/action_view/rendering.rb:39:in `process'
actionpack (7.0.7) lib/action_controller/metal.rb:188:in `dispatch'
actionpack (7.0.7) lib/action_controller/metal.rb:251:in `dispatch'
actionpack (7.0.7) lib/action_dispatch/routing/route_set.rb:49:in `dispatch'
actionpack (7.0.7) lib/action_dispatch/routing/route_set.rb:32:in `serve'
actionpack (7.0.7) lib/action_dispatch/journey/router.rb:50:in `block in serve'
actionpack (7.0.7) lib/action_dispatch/journey/router.rb:32:in `each'
actionpack (7.0.7) lib/action_dispatch/journey/router.rb:32:in `serve'
actionpack (7.0.7) lib/action_dispatch/routing/route_set.rb:852:in `call'
rack (2.2.8) lib/rack/session/abstract/id.rb:266:in `context'
rack (2.2.8) lib/rack/session/abstract/id.rb:260:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/cookies.rb:704:in `call'
warden (1.2.9) lib/warden/manager.rb:36:in `block in call'
warden (1.2.9) lib/warden/manager.rb:34:in `catch'
warden (1.2.9) lib/warden/manager.rb:34:in `call'
rack (2.2.8) lib/rack/etag.rb:27:in `call'
rack (2.2.8) lib/rack/conditional_get.rb:27:in `call'
rack (2.2.8) lib/rack/head.rb:12:in `call'
activerecord (7.0.7) lib/active_record/migration.rb:603:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
activesupport (7.0.7) lib/active_support/callbacks.rb:99:in `run_callbacks'
actionpack (7.0.7) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/actionable_exceptions.rb:17:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/debug_exceptions.rb:28:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/show_exceptions.rb:29:in `call'
railties (7.0.7) lib/rails/rack/logger.rb:40:in `call_app'
railties (7.0.7) lib/rails/rack/logger.rb:25:in `block in call'
activesupport (7.0.7) lib/active_support/tagged_logging.rb:99:in `block in tagged'
activesupport (7.0.7) lib/active_support/tagged_logging.rb:37:in `tagged'
activesupport (7.0.7) lib/active_support/tagged_logging.rb:99:in `tagged'
railties (7.0.7) lib/rails/rack/logger.rb:25:in `call'
sprockets-rails (3.4.2) lib/sprockets/rails/quiet_assets.rb:13:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/remote_ip.rb:93:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/request_id.rb:26:in `call'
rack (2.2.8) lib/rack/runtime.rb:22:in `call'
activesupport (7.0.7) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.0.7) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.0.7) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/static.rb:23:in `call'
rack (2.2.8) lib/rack/sendfile.rb:110:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/host_authorization.rb:137:in `call'
rack-cors (2.0.1) lib/rack/cors.rb:102:in `call'
railties (7.0.7) lib/rails/engine.rb:530:in `call'
puma (5.6.7) lib/puma/configuration.rb:252:in `call'
puma (5.6.7) lib/puma/request.rb:77:in `block in handle_request'
puma (5.6.7) lib/puma/thread_pool.rb:340:in `with_force_shutdown'
puma (5.6.7) lib/puma/request.rb:76:in `handle_request'
puma (5.6.7) lib/puma/server.rb:443:in `process_client'
puma (5.6.7) lib/puma/thread_pool.rb:147:in `block in spawn_thread'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from block (3 levels) in <class:Railtie> at /home/markpaul/.rbenv/versions/2.7.6/lib/ruby/gems/2.7.0/gems/actionpack-7.0.7/lib/action_controller/railtie.rb:80)
Started GET "/carts/1/get_cart" for 127.0.0.1 at 2023-10-04 10:55:28 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
AbstractController::ActionNotFound (The action 'get_cart' could not be found for CartsController):
  
actionpack (7.0.7) lib/abstract_controller/base.rb:146:in `process'
actionview (7.0.7) lib/action_view/rendering.rb:39:in `process'
actionpack (7.0.7) lib/action_controller/metal.rb:188:in `dispatch'
actionpack (7.0.7) lib/action_controller/metal.rb:251:in `dispatch'
actionpack (7.0.7) lib/action_dispatch/routing/route_set.rb:49:in `dispatch'
actionpack (7.0.7) lib/action_dispatch/routing/route_set.rb:32:in `serve'
actionpack (7.0.7) lib/action_dispatch/journey/router.rb:50:in `block in serve'
actionpack (7.0.7) lib/action_dispatch/journey/router.rb:32:in `each'
actionpack (7.0.7) lib/action_dispatch/journey/router.rb:32:in `serve'
actionpack (7.0.7) lib/action_dispatch/routing/route_set.rb:852:in `call'
rack (2.2.8) lib/rack/session/abstract/id.rb:266:in `context'
rack (2.2.8) lib/rack/session/abstract/id.rb:260:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/cookies.rb:704:in `call'
warden (1.2.9) lib/warden/manager.rb:36:in `block in call'
warden (1.2.9) lib/warden/manager.rb:34:in `catch'
warden (1.2.9) lib/warden/manager.rb:34:in `call'
rack (2.2.8) lib/rack/etag.rb:27:in `call'
rack (2.2.8) lib/rack/conditional_get.rb:27:in `call'
rack (2.2.8) lib/rack/head.rb:12:in `call'
activerecord (7.0.7) lib/active_record/migration.rb:603:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
activesupport (7.0.7) lib/active_support/callbacks.rb:99:in `run_callbacks'
actionpack (7.0.7) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/actionable_exceptions.rb:17:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/debug_exceptions.rb:28:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/show_exceptions.rb:29:in `call'
railties (7.0.7) lib/rails/rack/logger.rb:40:in `call_app'
railties (7.0.7) lib/rails/rack/logger.rb:25:in `block in call'
activesupport (7.0.7) lib/active_support/tagged_logging.rb:99:in `block in tagged'
activesupport (7.0.7) lib/active_support/tagged_logging.rb:37:in `tagged'
activesupport (7.0.7) lib/active_support/tagged_logging.rb:99:in `tagged'
railties (7.0.7) lib/rails/rack/logger.rb:25:in `call'
sprockets-rails (3.4.2) lib/sprockets/rails/quiet_assets.rb:13:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/remote_ip.rb:93:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/request_id.rb:26:in `call'
rack (2.2.8) lib/rack/runtime.rb:22:in `call'
activesupport (7.0.7) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.0.7) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.0.7) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/static.rb:23:in `call'
rack (2.2.8) lib/rack/sendfile.rb:110:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/host_authorization.rb:137:in `call'
rack-cors (2.0.1) lib/rack/cors.rb:102:in `call'
railties (7.0.7) lib/rails/engine.rb:530:in `call'
puma (5.6.7) lib/puma/configuration.rb:252:in `call'
puma (5.6.7) lib/puma/request.rb:77:in `block in handle_request'
puma (5.6.7) lib/puma/thread_pool.rb:340:in `with_force_shutdown'
puma (5.6.7) lib/puma/request.rb:76:in `handle_request'
puma (5.6.7) lib/puma/server.rb:443:in `process_client'
puma (5.6.7) lib/puma/thread_pool.rb:147:in `block in spawn_thread'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from block (3 levels) in <class:Railtie> at /home/markpaul/.rbenv/versions/2.7.6/lib/ruby/gems/2.7.0/gems/actionpack-7.0.7/lib/action_controller/railtie.rb:80)
Started GET "/carts/1/get_cart" for 127.0.0.1 at 2023-10-04 10:57:09 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (1.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by CartsController#get_cart as */*
  Parameters: {"id"=>"1"}
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
No template found for CartsController#get_cart, rendering head :no_content
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 204 No Content in 101ms (ActiveRecord: 13.4ms | Allocations: 27098)


Started GET "/carts/8/get_cart" for 127.0.0.1 at 2023-10-04 10:57:29 +0300
Processing by CartsController#get_cart as */*
  Parameters: {"id"=>"8"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
No template found for CartsController#get_cart, rendering head :no_content
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 204 No Content in 4ms (ActiveRecord: 0.7ms | Allocations: 2182)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from block (3 levels) in <class:Railtie> at /home/markpaul/.rbenv/versions/2.7.6/lib/ruby/gems/2.7.0/gems/actionpack-7.0.7/lib/action_controller/railtie.rb:80)
Started GET "/carts/1/get_cart" for 127.0.0.1 at 2023-10-04 10:58:49 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by CartsController#get_cart as */*
  Parameters: {"id"=>"1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 104ms (ActiveRecord: 4.6ms | Allocations: 28400)


  
NameError (undefined local variable or method `retrieve_cart_contents' for #<CartsController:0x0000000000a5c8>):
  
app/controllers/carts_controller.rb:9:in `get_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from block (3 levels) in <class:Railtie> at /home/markpaul/.rbenv/versions/2.7.6/lib/ruby/gems/2.7.0/gems/actionpack-7.0.7/lib/action_controller/railtie.rb:80)
Started GET "/carts/1/get_cart" for 127.0.0.1 at 2023-10-04 11:00:53 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by CartsController#get_cart as */*
  Parameters: {"id"=>"1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 96ms (ActiveRecord: 5.1ms | Allocations: 25605)


  
SyntaxError (/home/markpaul/projects/skyva-api/app/models/cart.rb:33: syntax error, unexpected end-of-input):
  
app/models/cart.rb:33: syntax error, unexpected end-of-input
app/models/cart.rb:33: syntax error, unexpected end-of-input
app/controllers/carts_controller.rb:9:in `get_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from block (3 levels) in <class:Railtie> at /home/markpaul/.rbenv/versions/2.7.6/lib/ruby/gems/2.7.0/gems/actionpack-7.0.7/lib/action_controller/railtie.rb:80)
Started GET "/carts/1/get_cart" for 127.0.0.1 at 2023-10-04 11:01:48 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by CartsController#get_cart as */*
  Parameters: {"id"=>"1"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara2@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.4ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:9:in `get_cart'
Completed 404 Not Found in 102ms (ActiveRecord: 5.9ms | Allocations: 29517)


  
ActiveRecord::RecordNotFound (Couldn't find Cart with 'id'=1):
  
app/controllers/carts_controller.rb:9:in `get_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts"[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-04 11:28:12 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
ActionController::RoutingError (No route matches [POST] "/add_to_cart"):
  
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-04 11:29:04 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
ActionController::RoutingError (No route matches [POST] "/add_to_cart"):
  
Started POST "/carts/add_to_cart" for 127.0.0.1 at 2023-10-04 11:29:15 +0300
  
ActionController::RoutingError (No route matches [POST] "/carts/add_to_cart"):
  
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-04 11:29:23 +0300
  
ActionController::RoutingError (No route matches [POST] "/add_to_cart"):
  
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-04 11:29:33 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
ActionController::RoutingError (No route matches [POST] "/add_to_cart"):
  
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-04 11:30:16 +0300
  
ActionController::RoutingError (No route matches [POST] "/add_to_cart"):
  
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-04 11:48:17 +0300
  
ActionController::RoutingError (No route matches [POST] "/add_to_cart"):
  
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-04 11:49:13 +0300
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
No template found for CartsController#add_to_cart, rendering head :no_content
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 204 No Content in 104ms (ActiveRecord: 9.5ms | Allocations: 30025)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-05 10:03:16 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (2.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
No template found for CartsController#add_to_cart, rendering head :no_content
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 204 No Content in 144ms (ActiveRecord: 10.1ms | Allocations: 27074)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[36mCart Load (8.1ms)[0m  [1m[34mSELECT "carts".* FROM "carts"[0m
Started POST "/carts/add_to_cart" for 127.0.0.1 at 2023-10-05 10:05:03 +0300
  
ActionController::RoutingError (No route matches [POST] "/carts/add_to_cart"):
  
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-05 10:05:12 +0300
  
ActionController::RoutingError (No route matches [POST] "/add_to_cart"):
  
Started POST "/carts/2/add_to_cart" for 127.0.0.1 at 2023-10-05 10:05:34 +0300
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"2"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
No template found for CartsController#add_to_cart, rendering head :no_content
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 204 No Content in 8ms (ActiveRecord: 1.0ms | Allocations: 2401)


Started POST "/carts/90/add_to_cart" for 127.0.0.1 at 2023-10-05 10:05:40 +0300
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"90"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
No template found for CartsController#add_to_cart, rendering head :no_content
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 204 No Content in 7ms (ActiveRecord: 0.9ms | Allocations: 2162)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/90/add_to_cart" for 127.0.0.1 at 2023-10-05 10:15:02 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"90"}
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
No template found for CartsController#add_to_cart, rendering head :no_content
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 204 No Content in 131ms (ActiveRecord: 6.9ms | Allocations: 27079)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/90/add_to_cart" for 127.0.0.1 at 2023-10-05 10:19:32 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"90"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 128ms (ActiveRecord: 5.6ms | Allocations: 25480)


  
ArgumentError (wrong number of arguments (given 0, expected 3)):
  
app/controllers/carts_controller.rb:4:in `add_to_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/90/add_to_cart" for 127.0.0.1 at 2023-10-05 10:21:59 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"90"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
  [1m[36mProduct Load (1.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:11:in `add_to_cart'
Completed 500 Internal Server Error in 160ms (ActiveRecord: 11.2ms | Allocations: 47439)


  
NoMethodError (undefined method `cart' for nil:NilClass):
  
app/controllers/carts_controller.rb:14:in `add_to_cart'
Started POST "/carts/90/add_to_cart" for 127.0.0.1 at 2023-10-05 10:23:09 +0300
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"90"}
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:11:in `add_to_cart'
Completed 500 Internal Server Error in 25ms (ActiveRecord: 6.4ms | Allocations: 7841)


  
NoMethodError (undefined method `cart' for nil:NilClass):
  
app/controllers/carts_controller.rb:14:in `add_to_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/90/add_to_cart" for 127.0.0.1 at 2023-10-05 10:24:26 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"90"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
  [1m[36mProduct Load (0.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:11:in `add_to_cart'
Completed 500 Internal Server Error in 155ms (ActiveRecord: 10.7ms | Allocations: 47437)


  
NoMethodError (undefined method `cart' for nil:NilClass):
  
app/controllers/carts_controller.rb:14:in `add_to_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/90/add_to_cart" for 127.0.0.1 at 2023-10-05 10:25:23 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"90"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara3@gmail.com"], ["LIMIT", 1]]
Current User: nil
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:12:in `add_to_cart'
Completed 500 Internal Server Error in 169ms (ActiveRecord: 12.4ms | Allocations: 47447)


  
NoMethodError (undefined method `cart' for nil:NilClass):
  
app/controllers/carts_controller.rb:15:in `add_to_cart'
Started POST "/auth" for 127.0.0.1 at 2023-10-05 10:26:27 +0300
Processing by Auth::RegistrationsController#create as */*
  Parameters: {"email"=>"markpaulmuthuara3@gmail.com", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "markpaulmuthuara3@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
Completed 422 Unprocessable Entity in 2511ms (Views: 0.7ms | ActiveRecord: 10.6ms | Allocations: 724516)


Started POST "/auth" for 127.0.0.1 at 2023-10-05 11:14:51 +0300
Processing by Auth::RegistrationsController#create as */*
  Parameters: {"email"=>"markpaulmuthuara5@gmail.com", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mUser Exists? (1.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "markpaulmuthuara5@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mUser Create (1.6ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "email", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["uid", "markpaulmuthuara5@gmail.com"], ["encrypted_password", "[FILTERED]"], ["email", "markpaulmuthuara5@gmail.com"], ["created_at", "2023-10-05 08:14:51.875669"], ["updated_at", "2023-10-05 08:14:51.875669"]]
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mUser Count (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "users"[0m
  ↳ app/controllers/auth/registrations_controller.rb:9:in `block in create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mUser Update (0.8ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "[FILTERED]"], ["updated_at", "2023-10-05 08:14:51.979412"], ["id", 3]]
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
Completed 200 OK in 501ms (Views: 0.3ms | ActiveRecord: 15.3ms | Allocations: 9574)


Started POST "/carts/90/add_to_cart" for 127.0.0.1 at 2023-10-05 11:15:17 +0300
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"90"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara5@gmail.com"], ["LIMIT", 1]]
Current User: nil
  [1m[36mProduct Load (0.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:12:in `add_to_cart'
Completed 500 Internal Server Error in 101ms (ActiveRecord: 0.8ms | Allocations: 2150)


  
NoMethodError (undefined method `cart' for nil:NilClass):
  
app/controllers/carts_controller.rb:15:in `add_to_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-05 11:31:49 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara5@gmail.com"], ["LIMIT", 1]]
Current User: nil
  [1m[36mProduct Load (0.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:12:in `add_to_cart'
Completed 500 Internal Server Error in 156ms (ActiveRecord: 10.6ms | Allocations: 47447)


  
NoMethodError (undefined method `cart' for nil:NilClass):
  
app/controllers/carts_controller.rb:15:in `add_to_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-09 09:46:30 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara5@gmail.com"], ["LIMIT", 1]]
Current User: nil
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:12:in `add_to_cart'
Completed 500 Internal Server Error in 119ms (ActiveRecord: 9.9ms | Allocations: 47451)


  
NoMethodError (undefined method `cart' for nil:NilClass):
  
app/controllers/carts_controller.rb:15:in `add_to_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-09 10:01:43 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara5@gmail.com"], ["LIMIT", 1]]
Current User: #<User id: 3, provider: "email", uid: "markpaulmuthuara5@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaulmuthuara5@gmail.com", created_at: "2023-10-05 08:14:51.875669000 +0000", updated_at: "2023-10-05 08:14:51.979412000 +0000", role: nil>
  [1m[36mProduct Load (0.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:43:in `add_to_cart'
  [1m[36mCart Load (0.5ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 3], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:53:in `add_to_cart'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/carts_controller.rb:54:in `add_to_cart'
  [1m[36mCart Create (1.2ms)[0m  [1m[32mINSERT INTO "carts" ("user_id", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["user_id", 3], ["created_at", "2023-10-09 07:01:44.192733"], ["updated_at", "2023-10-09 07:01:44.192733"]]
  ↳ app/controllers/carts_controller.rb:54:in `add_to_cart'
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/carts_controller.rb:54:in `add_to_cart'
  [1m[36mOrderItem Load (0.8ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."cart_id" = $1 AND "order_items"."product_id" = $2 LIMIT $3[0m  [["cart_id", 1], ["product_id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:58:in `add_to_cart'
Completed 500 Internal Server Error in 170ms (ActiveRecord: 16.9ms | Allocations: 95459)


  
NameError (undefined local variable or method `root_path' for #<CartsController:0x0000000000a780>
Did you mean?  cart_path):
  
app/controllers/carts_controller.rb:75:in `add_to_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-09 10:03:43 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara5@gmail.com"], ["LIMIT", 1]]
Current User: #<User id: 3, provider: "email", uid: "markpaulmuthuara5@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaulmuthuara5@gmail.com", created_at: "2023-10-05 08:14:51.875669000 +0000", updated_at: "2023-10-05 08:14:51.979412000 +0000", role: nil>
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:43:in `add_to_cart'
  [1m[36mCart Load (0.2ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 3], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:53:in `add_to_cart'
  [1m[36mOrderItem Load (0.3ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."cart_id" = $1 AND "order_items"."product_id" = $2 LIMIT $3[0m  [["cart_id", 1], ["product_id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:58:in `add_to_cart'
No template found for CartsController#add_to_cart, rendering head :no_content
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 204 No Content in 155ms (ActiveRecord: 11.5ms | Allocations: 92212)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[36mCart Load (0.7ms)[0m  [1m[34mSELECT "carts".* FROM "carts"[0m
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-09 10:22:31 +0300
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara5@gmail.com"], ["LIMIT", 1]]
Current User: #<User id: 3, provider: "email", uid: "markpaulmuthuara5@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaulmuthuara5@gmail.com", created_at: "2023-10-05 08:14:51.875669000 +0000", updated_at: "2023-10-05 08:14:51.979412000 +0000", role: nil>
  [1m[36mProduct Load (0.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:43:in `add_to_cart'
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 3], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:53:in `add_to_cart'
  [1m[36mOrderItem Load (0.3ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."cart_id" = $1 AND "order_items"."product_id" = $2 LIMIT $3[0m  [["cart_id", 1], ["product_id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:59:in `add_to_cart'
Product added to cart: #<OrderItem id: nil, order_id: nil, product_id: 1, quantity: 2, price: nil, created_at: nil, updated_at: nil, cart_id: 1>
Error saving cart or order item.
No template found for CartsController#add_to_cart, rendering head :no_content
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 204 No Content in 142ms (ActiveRecord: 7.4ms | Allocations: 29650)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_quantity" for 127.0.0.1 at 2023-10-09 10:35:00 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
ActionController::RoutingError (No route matches [POST] "/carts/1/add_quantity"):
  
Started POST "/carts/1/add_quantity" for 127.0.0.1 at 2023-10-09 10:36:09 +0300
  
ActionController::RoutingError (No route matches [POST] "/carts/1/add_quantity"):
  
Started PATCH "/carts/1/add_quantity" for 127.0.0.1 at 2023-10-09 10:38:04 +0300
  
ActionController::RoutingError (No route matches [PATCH] "/carts/1/add_quantity"):
  
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started PATCH "/carts/1/add_quantity" for 127.0.0.1 at 2023-10-09 10:38:32 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
ActionController::RoutingError (No route matches [PATCH] "/carts/1/add_quantity"):
  
Started PATCH "/carts/1/add_quantity/1" for 127.0.0.1 at 2023-10-09 10:45:04 +0300
  
ArgumentError (can't use member outside resource(s) scope):
  
config/routes.rb:17:in `block (3 levels) in <top (required)>'
config/routes.rb:12:in `block (2 levels) in <top (required)>'
config/routes.rb:11:in `block in <top (required)>'
config/routes.rb:3:in `<top (required)>'
Started PATCH "/carts/1/add_quantity/1" for 127.0.0.1 at 2023-10-09 10:45:47 +0300
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_quantity as */*
  Parameters: {"quantity"=>1, "id"=>"1", "product_id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 1174ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 726279)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started PATCH "/carts/1/add_quantity/1" for 127.0.0.1 at 2023-10-09 10:52:56 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_quantity as */*
  Parameters: {"quantity"=>1, "id"=>"1", "product_id"=>"1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara5@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.2ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 3], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:74:in `add_quantity'
Completed 500 Internal Server Error in 147ms (ActiveRecord: 7.8ms | Allocations: 47738)


  
NoMethodError (undefined method `cart_items' for #<Cart:0x00007f560c7e2660>):
  
app/controllers/carts_controller.rb:74:in `add_quantity'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started PATCH "/carts/1/add_quantity/1" for 127.0.0.1 at 2023-10-09 10:57:06 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_quantity as */*
  Parameters: {"quantity"=>1, "id"=>"1", "product_id"=>"1"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara5@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.4ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 3], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:74:in `add_quantity'
Completed 500 Internal Server Error in 108ms (ActiveRecord: 6.7ms | Allocations: 49089)


  
NameError (Rails couldn't find a valid model for CartItem association. Please provide the :class_name option on the association declaration. If :class_name is already provided, make sure it's an ActiveRecord::Base subclass.):
  
app/controllers/carts_controller.rb:74:in `add_quantity'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started PATCH "/carts/1/add_quantity/1" for 127.0.0.1 at 2023-10-09 11:17:58 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_quantity as */*
  Parameters: {"quantity"=>1, "id"=>"1", "product_id"=>"1"}
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara5@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.6ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 3], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:74:in `add_quantity'
Completed 500 Internal Server Error in 107ms (ActiveRecord: 8.5ms | Allocations: 49037)


  
NameError (Rails couldn't find a valid model for CartItem association. Please provide the :class_name option on the association declaration. If :class_name is already provided, make sure it's an ActiveRecord::Base subclass.):
  
app/controllers/carts_controller.rb:74:in `add_quantity'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started PATCH "/carts/1/add_quantity/1" for 127.0.0.1 at 2023-10-09 11:20:36 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_quantity as */*
  Parameters: {"quantity"=>1, "id"=>"1", "product_id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaulmuthuara5@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.2ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 3], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:74:in `add_quantity'
Completed 500 Internal Server Error in 106ms (ActiveRecord: 5.7ms | Allocations: 49028)


  
NameError (Rails couldn't find a valid model for CartItem association. Please provide the :class_name option on the association declaration. If :class_name is already provided, make sure it's an ActiveRecord::Base subclass.):
  
app/controllers/carts_controller.rb:74:in `add_quantity'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started PATCH "/carts/1/add_quantity/1" for 127.0.0.1 at 2023-10-09 22:54:37 +0300
  
ActiveRecord::NoDatabaseError (We could not find your database: skyva_api. Which can be found in the database configuration file located at config/database.yml.

To resolve this issue:

- Did you create the database for this app, or delete it? You may need to create your database.
- Has the database name changed? Check your database.yml config has the correct database name.

To create your database, run:

        bin/rails db:create
):
  
activerecord (7.0.7) lib/active_record/connection_adapters/postgresql_adapter.rb:81:in `rescue in new_client'
activerecord (7.0.7) lib/active_record/connection_adapters/postgresql_adapter.rb:77:in `new_client'
activerecord (7.0.7) lib/active_record/connection_adapters/postgresql_adapter.rb:37:in `postgresql_connection'
activerecord (7.0.7) lib/active_record/connection_adapters/abstract/connection_pool.rb:656:in `public_send'
activerecord (7.0.7) lib/active_record/connection_adapters/abstract/connection_pool.rb:656:in `new_connection'
activerecord (7.0.7) lib/active_record/connection_adapters/abstract/connection_pool.rb:700:in `checkout_new_connection'
activerecord (7.0.7) lib/active_record/connection_adapters/abstract/connection_pool.rb:679:in `try_to_checkout_new_connection'
activerecord (7.0.7) lib/active_record/connection_adapters/abstract/connection_pool.rb:640:in `acquire_connection'
activerecord (7.0.7) lib/active_record/connection_adapters/abstract/connection_pool.rb:341:in `checkout'
activerecord (7.0.7) lib/active_record/connection_adapters/abstract/connection_pool.rb:181:in `connection'
activerecord (7.0.7) lib/active_record/connection_adapters/abstract/connection_handler.rb:211:in `retrieve_connection'
activerecord (7.0.7) lib/active_record/connection_handling.rb:313:in `retrieve_connection'
activerecord (7.0.7) lib/active_record/connection_handling.rb:280:in `connection'
activerecord (7.0.7) lib/active_record/migration.rb:613:in `connection'
activerecord (7.0.7) lib/active_record/migration.rb:608:in `build_watcher'
activerecord (7.0.7) lib/active_record/migration.rb:590:in `block in call'
activerecord (7.0.7) lib/active_record/migration.rb:589:in `synchronize'
activerecord (7.0.7) lib/active_record/migration.rb:589:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
activesupport (7.0.7) lib/active_support/callbacks.rb:99:in `run_callbacks'
actionpack (7.0.7) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/actionable_exceptions.rb:17:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/debug_exceptions.rb:28:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/show_exceptions.rb:29:in `call'
railties (7.0.7) lib/rails/rack/logger.rb:40:in `call_app'
railties (7.0.7) lib/rails/rack/logger.rb:25:in `block in call'
activesupport (7.0.7) lib/active_support/tagged_logging.rb:99:in `block in tagged'
activesupport (7.0.7) lib/active_support/tagged_logging.rb:37:in `tagged'
activesupport (7.0.7) lib/active_support/tagged_logging.rb:99:in `tagged'
railties (7.0.7) lib/rails/rack/logger.rb:25:in `call'
sprockets-rails (3.4.2) lib/sprockets/rails/quiet_assets.rb:13:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/remote_ip.rb:93:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/request_id.rb:26:in `call'
rack (2.2.8) lib/rack/runtime.rb:22:in `call'
activesupport (7.0.7) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.0.7) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.0.7) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/static.rb:23:in `call'
rack (2.2.8) lib/rack/sendfile.rb:110:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/host_authorization.rb:137:in `call'
rack-cors (2.0.1) lib/rack/cors.rb:102:in `call'
railties (7.0.7) lib/rails/engine.rb:530:in `call'
puma (5.6.7) lib/puma/configuration.rb:252:in `call'
puma (5.6.7) lib/puma/request.rb:77:in `block in handle_request'
puma (5.6.7) lib/puma/thread_pool.rb:340:in `with_force_shutdown'
puma (5.6.7) lib/puma/request.rb:76:in `handle_request'
puma (5.6.7) lib/puma/server.rb:443:in `process_client'
puma (5.6.7) lib/puma/thread_pool.rb:147:in `block in spawn_thread'
Started PATCH "/carts/1/add_quantity/1" for 127.0.0.1 at 2023-10-09 22:55:28 +0300
  
ActiveRecord::NoDatabaseError (We could not find your database: skyva_api. Which can be found in the database configuration file located at config/database.yml.

To resolve this issue:

- Did you create the database for this app, or delete it? You may need to create your database.
- Has the database name changed? Check your database.yml config has the correct database name.

To create your database, run:

        bin/rails db:create
):
  
activerecord (7.0.7) lib/active_record/connection_adapters/postgresql_adapter.rb:81:in `rescue in new_client'
activerecord (7.0.7) lib/active_record/connection_adapters/postgresql_adapter.rb:77:in `new_client'
activerecord (7.0.7) lib/active_record/connection_adapters/postgresql_adapter.rb:37:in `postgresql_connection'
activerecord (7.0.7) lib/active_record/connection_adapters/abstract/connection_pool.rb:656:in `public_send'
activerecord (7.0.7) lib/active_record/connection_adapters/abstract/connection_pool.rb:656:in `new_connection'
activerecord (7.0.7) lib/active_record/connection_adapters/abstract/connection_pool.rb:700:in `checkout_new_connection'
activerecord (7.0.7) lib/active_record/connection_adapters/abstract/connection_pool.rb:679:in `try_to_checkout_new_connection'
activerecord (7.0.7) lib/active_record/connection_adapters/abstract/connection_pool.rb:640:in `acquire_connection'
activerecord (7.0.7) lib/active_record/connection_adapters/abstract/connection_pool.rb:341:in `checkout'
activerecord (7.0.7) lib/active_record/connection_adapters/abstract/connection_pool.rb:181:in `connection'
activerecord (7.0.7) lib/active_record/connection_adapters/abstract/connection_handler.rb:211:in `retrieve_connection'
activerecord (7.0.7) lib/active_record/connection_handling.rb:313:in `retrieve_connection'
activerecord (7.0.7) lib/active_record/connection_handling.rb:280:in `connection'
activerecord (7.0.7) lib/active_record/migration.rb:613:in `connection'
activerecord (7.0.7) lib/active_record/migration.rb:608:in `build_watcher'
activerecord (7.0.7) lib/active_record/migration.rb:590:in `block in call'
activerecord (7.0.7) lib/active_record/migration.rb:589:in `synchronize'
activerecord (7.0.7) lib/active_record/migration.rb:589:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
activesupport (7.0.7) lib/active_support/callbacks.rb:99:in `run_callbacks'
actionpack (7.0.7) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/actionable_exceptions.rb:17:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/debug_exceptions.rb:28:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/show_exceptions.rb:29:in `call'
railties (7.0.7) lib/rails/rack/logger.rb:40:in `call_app'
railties (7.0.7) lib/rails/rack/logger.rb:25:in `block in call'
activesupport (7.0.7) lib/active_support/tagged_logging.rb:99:in `block in tagged'
activesupport (7.0.7) lib/active_support/tagged_logging.rb:37:in `tagged'
activesupport (7.0.7) lib/active_support/tagged_logging.rb:99:in `tagged'
railties (7.0.7) lib/rails/rack/logger.rb:25:in `call'
sprockets-rails (3.4.2) lib/sprockets/rails/quiet_assets.rb:13:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/remote_ip.rb:93:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/request_id.rb:26:in `call'
rack (2.2.8) lib/rack/runtime.rb:22:in `call'
activesupport (7.0.7) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.0.7) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.0.7) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/static.rb:23:in `call'
rack (2.2.8) lib/rack/sendfile.rb:110:in `call'
actionpack (7.0.7) lib/action_dispatch/middleware/host_authorization.rb:137:in `call'
rack-cors (2.0.1) lib/rack/cors.rb:102:in `call'
railties (7.0.7) lib/rails/engine.rb:530:in `call'
puma (5.6.7) lib/puma/configuration.rb:252:in `call'
puma (5.6.7) lib/puma/request.rb:77:in `block in handle_request'
puma (5.6.7) lib/puma/thread_pool.rb:340:in `with_force_shutdown'
puma (5.6.7) lib/puma/request.rb:76:in `handle_request'
puma (5.6.7) lib/puma/server.rb:443:in `process_client'
puma (5.6.7) lib/puma/thread_pool.rb:147:in `block in spawn_thread'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[35m (814.5ms)[0m  [1m[35mCREATE DATABASE "skyva_api" ENCODING = 'unicode'[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE DATABASE "skyva_api" ENCODING = 'unicode'[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[35m (108.5ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[35m (104.3ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3422183495574815895)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to DeviseTokenAuthCreateUsers (20230819204134)
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (83.2ms)[0m  [1m[35mCREATE TABLE "users" ("id" bigserial primary key, "provider" character varying DEFAULT 'email' NOT NULL, "uid" character varying DEFAULT '' NOT NULL, "encrypted_password" character varying DEFAULT '' NOT NULL, "reset_password_token" character varying, "reset_password_sent_at" timestamp(6), "allow_password_change" boolean DEFAULT FALSE, "remember_created_at" timestamp(6), "confirmation_token" character varying, "confirmed_at" timestamp(6), "confirmation_sent_at" timestamp(6), "unconfirmed_email" character varying, "name" character varying, "nickname" character varying, "image" character varying, "email" character varying, "tokens" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (39.8ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_users_on_email" ON "users" ("email")[0m
  [1m[35m (39.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_users_on_uid_and_provider" ON "users" ("uid", "provider")[0m
  [1m[35m (40.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_users_on_reset_password_token" ON "users" ("reset_password_token")[0m
  [1m[35m (40.1ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_users_on_confirmation_token" ON "users" ("confirmation_token")[0m
  [1m[36mActiveRecord::SchemaMigration Create (1.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20230819204134"]]
  [1m[36mTRANSACTION (18.5ms)[0m  [1m[35mCOMMIT[0m
Migrating to AddRoleToUsers (20230821020342)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "users" ADD "role" integer[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20230821020342"]]
  [1m[36mTRANSACTION (7.8ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreatePosts (20230821021958)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (82.9ms)[0m  [1m[35mCREATE TABLE "posts" ("id" bigserial primary key, "title" character varying, "content" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.7ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20230821021958"]]
  [1m[36mTRANSACTION (13.9ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateActiveStorageTables (20230821023831)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (73.0ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" bigserial primary key, "key" character varying NOT NULL, "filename" character varying NOT NULL, "content_type" character varying, "metadata" text, "service_name" character varying NOT NULL, "byte_size" bigint NOT NULL, "checksum" character varying, "created_at" timestamp(6) NOT NULL)[0m
  [1m[35m (33.1ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (66.4ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" bigserial primary key, "name" character varying NOT NULL, "record_type" character varying NOT NULL, "record_id" bigint NOT NULL, "blob_id" bigint NOT NULL, "created_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_c3b3935057"
FOREIGN KEY ("blob_id")
  REFERENCES "active_storage_blobs" ("id")
)[0m
  [1m[35m (29.7ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (31.7ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (82.6ms)[0m  [1m[35mCREATE TABLE "active_storage_variant_records" ("id" bigserial primary key, "blob_id" bigint NOT NULL, "variation_digest" character varying NOT NULL, CONSTRAINT "fk_rails_993965df05"
FOREIGN KEY ("blob_id")
  REFERENCES "active_storage_blobs" ("id")
)[0m
  [1m[35m (39.1ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_variant_records_uniqueness" ON "active_storage_variant_records" ("blob_id", "variation_digest")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.7ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20230821023831"]]
  [1m[36mTRANSACTION (20.3ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateProducts (20230928093423)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (95.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" bigserial primary key, "name" character varying, "description" text, "price" decimal, "size" character varying, "color" character varying, "brand" character varying, "stock_quantity" integer, "category_id" bigint NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_fb915499a4"
FOREIGN KEY ("category_id")
  REFERENCES "categories" ("id")
)[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT pg_advisory_unlock(3422183495574815895)[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3422183495574815895)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateProducts (20230928093423)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (68.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" bigserial primary key, "name" character varying, "description" text, "price" decimal, "size" character varying, "color" character varying, "brand" character varying, "stock_quantity" integer, "category_id" bigint NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_fb915499a4"
FOREIGN KEY ("category_id")
  REFERENCES "categories" ("id")
)[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT pg_advisory_unlock(3422183495574815895)[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3422183495574815895)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateCategories (20230928093441)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (97.5ms)[0m  [1m[35mCREATE TABLE "categories" ("id" bigserial primary key, "name" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20230928093441"]]
  [1m[36mTRANSACTION (15.6ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateOrders (20230928093450)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (87.0ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "user_id" bigint NOT NULL, "status" character varying, "total_amount" decimal, "shipping_address" text, "payment_details" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_f868b47f6a"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (46.5ms)[0m  [1m[35mCREATE INDEX "index_orders_on_user_id" ON "orders" ("user_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.7ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20230928093450"]]
  [1m[36mTRANSACTION (16.5ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateOrderItems (20230928093507)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (67.7ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" bigint NOT NULL, "product_id" bigint NOT NULL, "quantity" integer, "price" decimal, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_e3cb28f071"
FOREIGN KEY ("order_id")
  REFERENCES "orders" ("id")
, CONSTRAINT "fk_rails_f1a29ddd47"
FOREIGN KEY ("product_id")
  REFERENCES "products" ("id")
)[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT pg_advisory_unlock(3422183495574815895)[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3422183495574815895)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateProducts (20230928093423)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (85.3ms)[0m  [1m[35mCREATE TABLE "products" ("id" bigserial primary key, "name" character varying, "description" text, "price" decimal, "size" character varying, "color" character varying, "brand" character varying, "stock_quantity" integer, "category_id" bigint NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_fb915499a4"
FOREIGN KEY ("category_id")
  REFERENCES "categories" ("id")
)[0m
  [1m[35m (39.1ms)[0m  [1m[35mCREATE INDEX "index_products_on_category_id" ON "products" ("category_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20230928093423"]]
  [1m[36mTRANSACTION (16.9ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateOrderItems (20230928093507)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (93.1ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" bigint NOT NULL, "product_id" bigint NOT NULL, "quantity" integer, "price" decimal, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_e3cb28f071"
FOREIGN KEY ("order_id")
  REFERENCES "orders" ("id")
, CONSTRAINT "fk_rails_f1a29ddd47"
FOREIGN KEY ("product_id")
  REFERENCES "products" ("id")
)[0m
  [1m[35m (39.2ms)[0m  [1m[35mCREATE INDEX "index_order_items_on_order_id" ON "order_items" ("order_id")[0m
  [1m[35m (40.5ms)[0m  [1m[35mCREATE INDEX "index_order_items_on_product_id" ON "order_items" ("product_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20230928093507"]]
  [1m[36mTRANSACTION (17.6ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateCarts (20230928093648)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (32.0ms)[0m  [1m[35mCREATE TABLE "carts" ("id" bigserial primary key, "user_id" bigint NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_ea59a35211"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (40.1ms)[0m  [1m[35mCREATE INDEX "index_carts_on_user_id" ON "carts" ("user_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20230928093648"]]
  [1m[36mTRANSACTION (18.2ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateAddresses (20230928093657)
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (83.0ms)[0m  [1m[35mCREATE TABLE "addresses" ("id" bigserial primary key, "user_id" bigint NOT NULL, "address_type" character varying, "street" character varying, "city" character varying, "state" character varying, "postal_code" character varying, "country" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_48c9e0c5a2"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (39.8ms)[0m  [1m[35mCREATE INDEX "index_addresses_on_user_id" ON "addresses" ("user_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.7ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20230928093657"]]
  [1m[36mTRANSACTION (27.9ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateReceipts (20230928094034)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (37.8ms)[0m  [1m[35mCREATE TABLE "receipts" ("id" bigserial primary key, "order_id" bigint NOT NULL, "user_id" bigint NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_de8c1572cc"
FOREIGN KEY ("order_id")
  REFERENCES "orders" ("id")
, CONSTRAINT "fk_rails_b2d4d3fa14"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (39.5ms)[0m  [1m[35mCREATE INDEX "index_receipts_on_order_id" ON "receipts" ("order_id")[0m
  [1m[35m (40.2ms)[0m  [1m[35mCREATE INDEX "index_receipts_on_user_id" ON "receipts" ("user_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20230928094034"]]
  [1m[36mTRANSACTION (15.7ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateBrands (20231002082120)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (86.6ms)[0m  [1m[35mCREATE TABLE "brands" ("id" bigserial primary key, "name" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20231002082120"]]
  [1m[36mTRANSACTION (16.0ms)[0m  [1m[35mCOMMIT[0m
Migrating to AddCartReferenceToOrderItems (20231002130233)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "order_items" ADD "cart_id" bigint NOT NULL[0m
  [1m[35m (39.9ms)[0m  [1m[35mCREATE INDEX "index_order_items_on_cart_id" ON "order_items" ("cart_id")[0m
  [1m[35m (2.2ms)[0m  [1m[35mALTER TABLE "order_items" ADD CONSTRAINT "fk_rails_59f7f23852"
FOREIGN KEY ("cart_id")
  REFERENCES "carts" ("id")
[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20231002130233"]]
  [1m[36mTRANSACTION (17.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (1.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2023-10-09 19:59:10.766520"], ["updated_at", "2023-10-09 19:59:10.766520"]]
  [1m[36mTRANSACTION (14.8ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT pg_advisory_unlock(3422183495574815895)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCategory Create (0.4ms)[0m  [1m[32mINSERT INTO "categories" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Clothes"], ["description", "Clothing category"], ["created_at", "2023-10-09 20:00:26.467386"], ["updated_at", "2023-10-09 20:00:26.467386"]]
  [1m[36mTRANSACTION (13.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCategory Create (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Shoes"], ["description", "Footwear category"], ["created_at", "2023-10-09 20:00:26.484455"], ["updated_at", "2023-10-09 20:00:26.484455"]]
  [1m[36mTRANSACTION (3.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCategory Create (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Jewelry"], ["description", "Jewelry category"], ["created_at", "2023-10-09 20:00:26.492708"], ["updated_at", "2023-10-09 20:00:26.492708"]]
  [1m[36mTRANSACTION (3.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCategory Create (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Men"], ["description", "Men's clothing"], ["created_at", "2023-10-09 20:00:26.501681"], ["updated_at", "2023-10-09 20:00:26.501681"]]
  [1m[36mTRANSACTION (2.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCategory Create (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Women"], ["description", "Women's clothing"], ["created_at", "2023-10-09 20:00:26.509944"], ["updated_at", "2023-10-09 20:00:26.509944"]]
  [1m[36mTRANSACTION (2.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBrand Create (0.4ms)[0m  [1m[32mINSERT INTO "brands" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Hilpert Group"], ["description", "Quia est fugiat minima."], ["created_at", "2023-10-09 20:00:27.609775"], ["updated_at", "2023-10-09 20:00:27.609775"]]
  [1m[36mTRANSACTION (21.7ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBrand Create (0.3ms)[0m  [1m[32mINSERT INTO "brands" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Feil and Sons"], ["description", "Soluta neque deleniti sit."], ["created_at", "2023-10-09 20:00:27.634412"], ["updated_at", "2023-10-09 20:00:27.634412"]]
  [1m[36mTRANSACTION (5.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBrand Create (0.3ms)[0m  [1m[32mINSERT INTO "brands" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Cummings Group"], ["description", "Autem sunt necessitatibus voluptatem."], ["created_at", "2023-10-09 20:00:27.642495"], ["updated_at", "2023-10-09 20:00:27.642495"]]
  [1m[36mTRANSACTION (5.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBrand Create (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Rempel LLC"], ["description", "Quisquam debitis ex recusandae."], ["created_at", "2023-10-09 20:00:27.651645"], ["updated_at", "2023-10-09 20:00:27.651645"]]
  [1m[36mTRANSACTION (2.7ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBrand Create (0.3ms)[0m  [1m[32mINSERT INTO "brands" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Schaefer LLC"], ["description", "Exercitationem non tempora nostrum."], ["created_at", "2023-10-09 20:00:27.659033"], ["updated_at", "2023-10-09 20:00:27.659033"]]
  [1m[36mTRANSACTION (5.4ms)[0m  [1m[35mCOMMIT[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started PATCH "/carts/1/add_quantity/1" for 127.0.0.1 at 2023-10-09 23:00:45 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_quantity as */*
  Parameters: {"quantity"=>2, "id"=>"1", "product_id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 969ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 969826)


Started POST "/auth" for 127.0.0.1 at 2023-10-09 23:03:04 +0300
Processing by Auth::RegistrationsController#create as */*
  Parameters: {"email"=>"markpaul@gmail.com", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "markpaul@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "email", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["uid", "markpaul@gmail.com"], ["encrypted_password", "[FILTERED]"], ["email", "markpaul@gmail.com"], ["created_at", "2023-10-09 20:03:04.442925"], ["updated_at", "2023-10-09 20:03:04.442925"]]
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mTRANSACTION (11.7ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mUser Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "users"[0m
  ↳ app/controllers/auth/registrations_controller.rb:9:in `block in create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/auth/registrations_controller.rb:10:in `block in create'
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "role" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2023-10-09 20:03:04.459341"], ["role", 1], ["id", 1]]
  ↳ app/controllers/auth/registrations_controller.rb:10:in `block in create'
  [1m[36mTRANSACTION (3.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/auth/registrations_controller.rb:10:in `block in create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "[FILTERED]"], ["updated_at", "2023-10-09 20:03:04.517307"], ["id", 1]]
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mTRANSACTION (2.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
Completed 200 OK in 309ms (Views: 0.3ms | ActiveRecord: 25.8ms | Allocations: 23900)


Started PATCH "/carts/1/add_quantity/1" for 127.0.0.1 at 2023-10-09 23:03:23 +0300
Processing by CartsController#add_quantity as */*
  Parameters: {"quantity"=>2, "id"=>"1", "product_id"=>"1"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.6ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:74:in `add_quantity'
Completed 500 Internal Server Error in 117ms (ActiveRecord: 2.3ms | Allocations: 9196)


  
NoMethodError (undefined method `cart_items' for nil:NilClass

    cart_item = current_user.cart.cart_items.find(params[:cart_item_id])
                                 ^^^^^^^^^^^):
  
app/controllers/carts_controller.rb:74:in `add_quantity'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started PATCH "/carts/1/add_quantity/1" for 127.0.0.1 at 2023-10-09 23:10:14 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_quantity as */*
  Parameters: {"quantity"=>2, "id"=>"1", "product_id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:84:in `add_quantity'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 404 Not Found in 92ms (Views: 0.2ms | ActiveRecord: 5.7ms | Allocations: 22615)


Started PATCH "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-09 23:11:11 +0300
  
ActionController::RoutingError (No route matches [PATCH] "/carts/1/add_to_cart"):
  
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-09 23:11:20 +0300
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 1032ms (Views: 0.1ms | ActiveRecord: 0.0ms | Allocations: 969514)


Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-09 23:11:41 +0300
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
Current User: #<User id: 1, provider: "email", uid: "markpaul@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul@gmail.com", created_at: "2023-10-09 20:03:04.442925000 +0000", updated_at: "2023-10-09 20:03:04.517307000 +0000", role: "admin">
  [1m[36mProduct Load (0.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:12:in `add_to_cart'
Completed 500 Internal Server Error in 18ms (ActiveRecord: 2.3ms | Allocations: 8282)


  
NameError (undefined local variable or method `root_path' for #<CartsController:0x0000000000a2d0>

      redirect_to root_path # You can customize this redirect as needed
                  ^^^^^^^^^
Did you mean?  cart_path):
  
app/controllers/carts_controller.rb:17:in `add_to_cart'
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-09 23:12:31 +0300
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
Current User: #<User id: 1, provider: "email", uid: "markpaul@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul@gmail.com", created_at: "2023-10-09 20:03:04.442925000 +0000", updated_at: "2023-10-09 20:03:04.517307000 +0000", role: "admin">
  [1m[36mProduct Load (0.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:12:in `add_to_cart'
No template found for CartsController#add_to_cart, rendering head :no_content
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 204 No Content in 95ms (ActiveRecord: 5.3ms | Allocations: 12475)


Started PATCH "/carts/1/add_quantity/1" for 127.0.0.1 at 2023-10-09 23:12:40 +0300
Processing by CartsController#add_quantity as */*
  Parameters: {"quantity"=>2, "id"=>"1", "product_id"=>"1"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.4ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:84:in `add_quantity'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 404 Not Found in 14ms (Views: 0.3ms | ActiveRecord: 2.3ms | Allocations: 5538)


Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-09 23:12:48 +0300
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
Current User: #<User id: 1, provider: "email", uid: "markpaul@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul@gmail.com", created_at: "2023-10-09 20:03:04.442925000 +0000", updated_at: "2023-10-09 20:03:04.517307000 +0000", role: "admin">
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:12:in `add_to_cart'
No template found for CartsController#add_to_cart, rendering head :no_content
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 204 No Content in 6ms (ActiveRecord: 0.8ms | Allocations: 3144)


Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-09 23:12:49 +0300
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
Current User: #<User id: 1, provider: "email", uid: "markpaul@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul@gmail.com", created_at: "2023-10-09 20:03:04.442925000 +0000", updated_at: "2023-10-09 20:03:04.517307000 +0000", role: "admin">
  [1m[36mProduct Load (0.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:12:in `add_to_cart'
No template found for CartsController#add_to_cart, rendering head :no_content
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 204 No Content in 7ms (ActiveRecord: 1.0ms | Allocations: 3023)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[36mCart Load (0.4ms)[0m  [1m[34mSELECT "carts".* FROM "carts"[0m
Started POST "/create_product" for 127.0.0.1 at 2023-10-09 23:17:00 +0300
  
ActionController::RoutingError (No route matches [POST] "/create_product"):
  
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/create_product" for 127.0.0.1 at 2023-10-09 23:18:55 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
ActionController::RoutingError (No route matches [POST] "/create_product"):
  
Started POST "/create_product" for 127.0.0.1 at 2023-10-09 23:20:06 +0300
  
ActionController::RoutingError (No route matches [POST] "/create_product"):
  
Started POST "/products/create_product" for 127.0.0.1 at 2023-10-09 23:30:41 +0300
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.3ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (1.0ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-09 20:30:42.010970"], ["updated_at", "2023-10-09 20:30:42.010970"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (13.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 179ms (Views: 0.6ms | ActiveRecord: 30.1ms | Allocations: 35248)


Started POST "/products/create_product" for 127.0.0.1 at 2023-10-09 23:30:47 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.3ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.4ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-09 20:30:47.387355"], ["updated_at", "2023-10-09 20:30:47.387355"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (12.5ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 23ms (Views: 0.3ms | ActiveRecord: 14.1ms | Allocations: 5192)


Started POST "/products/create_product" for 127.0.0.1 at 2023-10-09 23:30:48 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.5ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-09 20:30:48.461521"], ["updated_at", "2023-10-09 20:30:48.461521"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (12.9ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 28ms (Views: 0.8ms | ActiveRecord: 14.9ms | Allocations: 5073)


Started POST "/products/create_product" for 127.0.0.1 at 2023-10-09 23:30:49 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.5ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.8ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-09 20:30:49.066294"], ["updated_at", "2023-10-09 20:30:49.066294"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (14.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 37ms (Views: 0.4ms | ActiveRecord: 17.1ms | Allocations: 5095)


Started POST "/products/create_product" for 127.0.0.1 at 2023-10-09 23:30:49 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.7ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-09 20:30:49.346531"], ["updated_at", "2023-10-09 20:30:49.346531"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (17.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 46ms (Views: 0.8ms | ActiveRecord: 20.7ms | Allocations: 5062)


Started POST "/products/create_product" for 127.0.0.1 at 2023-10-09 23:30:49 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.3ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.8ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-09 20:30:49.507244"], ["updated_at", "2023-10-09 20:30:49.507244"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (8.4ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 26ms (Views: 0.7ms | ActiveRecord: 11.3ms | Allocations: 5067)


Started POST "/products/create_product" for 127.0.0.1 at 2023-10-09 23:30:49 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.7ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-09 20:30:49.707533"], ["updated_at", "2023-10-09 20:30:49.707533"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (16.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 40ms (Views: 0.5ms | ActiveRecord: 19.3ms | Allocations: 5098)


Started POST "/products/create_product" for 127.0.0.1 at 2023-10-09 23:30:49 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.3ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-09 20:30:49.817995"], ["updated_at", "2023-10-09 20:30:49.817995"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (15.5ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 28ms (Views: 0.7ms | ActiveRecord: 16.9ms | Allocations: 5082)


Started POST "/products/create_product" for 127.0.0.1 at 2023-10-09 23:30:49 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.7ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-09 20:30:49.989281"], ["updated_at", "2023-10-09 20:30:49.989281"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (17.5ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 33ms (Views: 0.3ms | ActiveRecord: 19.8ms | Allocations: 5079)


Started POST "/products/create_product" for 127.0.0.1 at 2023-10-09 23:30:50 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.7ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-09 20:30:50.155331"], ["updated_at", "2023-10-09 20:30:50.155331"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (10.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 27ms (Views: 0.5ms | ActiveRecord: 12.6ms | Allocations: 5088)


Started POST "/products/create_product" for 127.0.0.1 at 2023-10-09 23:30:50 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.5ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.6ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-09 20:30:50.341376"], ["updated_at", "2023-10-09 20:30:50.341376"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (7.4ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 29ms (Views: 0.4ms | ActiveRecord: 10.0ms | Allocations: 5070)


Started POST "/products/create_product" for 127.0.0.1 at 2023-10-09 23:30:50 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (1.0ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-09 20:30:50.488910"], ["updated_at", "2023-10-09 20:30:50.488910"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (8.7ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 34ms (Views: 0.4ms | ActiveRecord: 11.8ms | Allocations: 5082)


Started POST "/products/create_product" for 127.0.0.1 at 2023-10-09 23:30:50 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.6ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-09 20:30:50.615822"], ["updated_at", "2023-10-09 20:30:50.615822"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (14.6ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 55ms (Views: 0.9ms | ActiveRecord: 16.6ms | Allocations: 5064)


Started POST "/products/create_product" for 127.0.0.1 at 2023-10-09 23:30:50 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.4ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.6ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-09 20:30:50.808210"], ["updated_at", "2023-10-09 20:30:50.808210"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (12.9ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 64ms (Views: 0.3ms | ActiveRecord: 14.6ms | Allocations: 5071)


Started POST "/products/create_product" for 127.0.0.1 at 2023-10-09 23:30:50 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.8ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.7ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-09 20:30:50.989123"], ["updated_at", "2023-10-09 20:30:50.989123"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (15.8ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 39ms (Views: 0.4ms | ActiveRecord: 18.6ms | Allocations: 5061)


Started POST "/products/create_product" for 127.0.0.1 at 2023-10-09 23:30:51 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.3ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.4ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-09 20:30:51.119763"], ["updated_at", "2023-10-09 20:30:51.119763"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (20.8ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 33ms (Views: 0.3ms | ActiveRecord: 22.2ms | Allocations: 5082)


Started POST "/products/create_product" for 127.0.0.1 at 2023-10-09 23:30:51 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.8ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-09 20:30:51.327538"], ["updated_at", "2023-10-09 20:30:51.327538"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (11.8ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 34ms (Views: 0.4ms | ActiveRecord: 14.7ms | Allocations: 5092)


Started POST "/products/create_product" for 127.0.0.1 at 2023-10-09 23:30:51 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.5ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (1.3ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-09 20:30:51.482672"], ["updated_at", "2023-10-09 20:30:51.482672"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (14.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 35ms (Views: 0.5ms | ActiveRecord: 17.3ms | Allocations: 5082)


Started POST "/products/create_product" for 127.0.0.1 at 2023-10-09 23:30:51 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.4ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.6ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-09 20:30:51.639623"], ["updated_at", "2023-10-09 20:30:51.639623"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (16.4ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 33ms (Views: 0.4ms | ActiveRecord: 18.6ms | Allocations: 5073)


Started POST "/products/create_product" for 127.0.0.1 at 2023-10-09 23:30:51 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.3ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.8ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-09 20:30:51.832473"], ["updated_at", "2023-10-09 20:30:51.832473"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (16.0ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 28ms (Views: 0.3ms | ActiveRecord: 18.0ms | Allocations: 5073)


Started POST "/products/create_product" for 127.0.0.1 at 2023-10-09 23:30:51 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.7ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-09 20:30:51.988116"], ["updated_at", "2023-10-09 20:30:51.988116"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (17.8ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 35ms (Views: 0.4ms | ActiveRecord: 20.0ms | Allocations: 5077)


Started POST "/products/create_product" for 127.0.0.1 at 2023-10-09 23:30:52 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.4ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.6ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-09 20:30:52.137700"], ["updated_at", "2023-10-09 20:30:52.137700"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (10.6ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 27ms (Views: 0.5ms | ActiveRecord: 12.6ms | Allocations: 5085)


Started POST "/products/create_product" for 127.0.0.1 at 2023-10-09 23:30:52 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (1.1ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-09 20:30:52.332533"], ["updated_at", "2023-10-09 20:30:52.332533"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (13.0ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 38ms (Views: 0.6ms | ActiveRecord: 16.2ms | Allocations: 5073)


Started POST "/products/create_product" for 127.0.0.1 at 2023-10-09 23:30:52 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (1.1ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-09 20:30:52.495967"], ["updated_at", "2023-10-09 20:30:52.495967"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (8.9ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 31ms (Views: 0.5ms | ActiveRecord: 12.2ms | Allocations: 5052)


Started POST "/products/create_product" for 127.0.0.1 at 2023-10-09 23:30:52 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.5ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-09 20:30:52.633880"], ["updated_at", "2023-10-09 20:30:52.633880"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (6.8ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 16ms (Views: 0.4ms | ActiveRecord: 8.0ms | Allocations: 5079)


Started POST "/products/create_product" for 127.0.0.1 at 2023-10-09 23:30:52 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.4ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.7ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-09 20:30:52.830677"], ["updated_at", "2023-10-09 20:30:52.830677"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (9.0ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 26ms (Views: 0.4ms | ActiveRecord: 11.1ms | Allocations: 5058)


Started POST "/products/create_product" for 127.0.0.1 at 2023-10-09 23:30:52 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.5ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-09 20:30:52.965177"], ["updated_at", "2023-10-09 20:30:52.965177"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (16.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 30ms (Views: 0.5ms | ActiveRecord: 17.6ms | Allocations: 5064)


Started POST "/products/create_product" for 127.0.0.1 at 2023-10-09 23:30:53 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.4ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (1.0ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-09 20:30:53.162205"], ["updated_at", "2023-10-09 20:30:53.162205"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (8.7ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 29ms (Views: 0.4ms | ActiveRecord: 11.6ms | Allocations: 5070)


Started POST "/products/create_product" for 127.0.0.1 at 2023-10-09 23:30:53 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.8ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-09 20:30:53.750807"], ["updated_at", "2023-10-09 20:30:53.750807"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (13.6ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 27ms (Views: 0.4ms | ActiveRecord: 15.3ms | Allocations: 5067)


Started POST "/products/create_product" for 127.0.0.1 at 2023-10-09 23:30:55 +0300
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"New Product", "description"=>"A description of the new product", "price"=>29.99, "size"=>"Medium", "stock_quantity"=>6, "brand"=>"LV", "color"=>"Blue", "category_id"=>1}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:42:in `require_admin'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mCategory Load (0.3ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mProduct Create (0.6ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "size", "color", "brand", "stock_quantity", "category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "New Product"], ["description", "A description of the new product"], ["price", "29.99"], ["size", "Medium"], ["color", "Blue"], ["brand", "LV"], ["stock_quantity", 6], ["category_id", 1], ["created_at", "2023-10-09 20:30:55.455653"], ["updated_at", "2023-10-09 20:30:55.455653"]]
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mTRANSACTION (10.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:10:in `create'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 201 Created in 23ms (Views: 0.4ms | ActiveRecord: 12.0ms | Allocations: 5068)


Started POST "/auth" for 127.0.0.1 at 2023-10-09 23:31:23 +0300
Processing by Auth::RegistrationsController#create as */*
  Parameters: {"email"=>"markpaul1@gmail.com", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "markpaul1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "email", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["uid", "markpaul1@gmail.com"], ["encrypted_password", "[FILTERED]"], ["email", "markpaul1@gmail.com"], ["created_at", "2023-10-09 20:31:24.546947"], ["updated_at", "2023-10-09 20:31:24.546947"]]
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mTRANSACTION (8.9ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mUser Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "users"[0m
  ↳ app/controllers/auth/registrations_controller.rb:9:in `block in create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "[FILTERED]"], ["updated_at", "2023-10-09 20:31:24.609509"], ["id", 2]]
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mTRANSACTION (3.6ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/auth/registrations_controller.rb:7:in `create'
Completed 200 OK in 1300ms (Views: 0.3ms | ActiveRecord: 15.4ms | Allocations: 977710)


Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-09 23:32:06 +0300
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
Current User: #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:12:in `add_to_cart'
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:22:in `add_to_cart'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/carts_controller.rb:23:in `add_to_cart'
  [1m[36mCart Create (0.7ms)[0m  [1m[32mINSERT INTO "carts" ("user_id", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["user_id", 2], ["created_at", "2023-10-09 20:32:06.805325"], ["updated_at", "2023-10-09 20:32:06.805325"]]
  ↳ app/controllers/carts_controller.rb:23:in `add_to_cart'
  [1m[36mTRANSACTION (20.5ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/carts_controller.rb:23:in `add_to_cart'
  [1m[36mOrderItem Load (0.4ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."cart_id" = $1 AND "order_items"."product_id" = $2 LIMIT $3[0m  [["cart_id", 1], ["product_id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:27:in `add_to_cart'
No template found for CartsController#add_to_cart, rendering head :no_content
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 204 No Content in 134ms (ActiveRecord: 29.2ms | Allocations: 21439)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[36mCart Load (0.4ms)[0m  [1m[34mSELECT "carts".* FROM "carts"[0m
Started PATCH "/carts/1/add_quantity/1" for 127.0.0.1 at 2023-10-09 23:32:52 +0300
Processing by CartsController#add_quantity as */*
  Parameters: {"quantity"=>2, "id"=>"1", "product_id"=>"1"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:84:in `add_quantity'
Completed 500 Internal Server Error in 8ms (ActiveRecord: 0.5ms | Allocations: 5655)


  
NameError (Rails couldn't find a valid model for CartItem association. Please provide the :class_name option on the association declaration. If :class_name is already provided, make sure it's an ActiveRecord::Base subclass.

          raise NameError, msg
          ^^^^^):
  
app/controllers/carts_controller.rb:91:in `add_quantity'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started PATCH "/carts/1/add_quantity/1" for 127.0.0.1 at 2023-10-09 23:42:42 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_quantity as */*
  Parameters: {"quantity"=>2, "id"=>"1", "product_id"=>"1"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:84:in `add_quantity'
Completed 404 Not Found in 103ms (ActiveRecord: 9.6ms | Allocations: 26786)


  
ActiveRecord::RecordNotFound (Couldn't find OrderItem without an ID):
  
app/controllers/carts_controller.rb:91:in `add_quantity'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started PATCH "/carts/1/add_quantity/1" for 127.0.0.1 at 2023-10-09 23:58:43 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_quantity as */*
  Parameters: {"quantity"=>2, "id"=>"1", "product_id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.2ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:84:in `add_quantity'
Completed 404 Not Found in 103ms (ActiveRecord: 8.8ms | Allocations: 26791)


  
ActiveRecord::RecordNotFound (Couldn't find OrderItem without an ID):
  
app/controllers/carts_controller.rb:91:in `add_quantity'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started PATCH "/carts/1/add_quantity/1" for 127.0.0.1 at 2023-10-09 23:59:46 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_quantity as */*
  Parameters: {"quantity"=>2, "id"=>"1", "product_id"=>"1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.4ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:113:in `add_quantity'
  [1m[36mOrderItem Load (0.6ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."cart_id" = $1 AND "order_items"."id" IS NULL LIMIT $2[0m  [["cart_id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:120:in `add_quantity'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 404 Not Found in 107ms (Views: 0.3ms | ActiveRecord: 9.8ms | Allocations: 28887)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started PATCH "/carts/1/add_quantity/1" for 127.0.0.1 at 2023-10-10 00:00:57 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_quantity as */*
  Parameters: {"quantity"=>2, "id"=>"1", "product_id"=>"1"}
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.4ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:113:in `add_quantity'
  [1m[36mOrderItem Load (0.4ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."cart_id" = $1 AND "order_items"."id" IS NULL LIMIT $2[0m  [["cart_id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:120:in `add_quantity'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 404 Not Found in 107ms (Views: 0.4ms | ActiveRecord: 11.1ms | Allocations: 28887)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCart Load (0.9ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCart Load (0.5ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mCart Load (0.2ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  [1m[36mOrderItem Load (0.3ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."cart_id" = $1[0m  [["cart_id", 1]]
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products"[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mCart Load (0.2ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  [1m[36mOrderItem Load (0.4ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."cart_id" = $1[0m  [["cart_id", 1]]
  [1m[36mOrderItem Load (1.2ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items"[0m
  [1m[36mOrderItem Load (0.3ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items"[0m
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-10 00:34:32 +0300
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>2, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
Current User: #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>
  [1m[36mProduct Load (0.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:12:in `add_to_cart'
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:22:in `add_to_cart'
  [1m[36mOrderItem Load (0.7ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."cart_id" = $1 AND "order_items"."product_id" = $2 LIMIT $3[0m  [["cart_id", 1], ["product_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:27:in `add_to_cart'
No template found for CartsController#add_to_cart, rendering head :no_content
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 204 No Content in 123ms (ActiveRecord: 13.8ms | Allocations: 31913)


Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-10 00:34:41 +0300
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>3, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
Current User: #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:12:in `add_to_cart'
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:22:in `add_to_cart'
  [1m[36mOrderItem Load (0.4ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."cart_id" = $1 AND "order_items"."product_id" = $2 LIMIT $3[0m  [["cart_id", 1], ["product_id", 3], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:27:in `add_to_cart'
No template found for CartsController#add_to_cart, rendering head :no_content
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 204 No Content in 14ms (ActiveRecord: 2.1ms | Allocations: 5107)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-10 00:40:51 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>3, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
Current User: #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:54:in `add_to_cart'
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:63:in `add_to_cart'
  [1m[36mOrderItem Load (0.8ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."cart_id" = $1 AND "order_items"."product_id" = $2 LIMIT $3[0m  [["cart_id", 1], ["product_id", 3], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:68:in `add_to_cart'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 132ms (Views: 0.2ms | ActiveRecord: 15.7ms | Allocations: 42801)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-10 00:44:36 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>3, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
Current User: #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:54:in `add_to_cart'
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:63:in `add_to_cart'
  [1m[36mOrderItem Load (0.3ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."cart_id" = $1 AND "order_items"."product_id" = $2 LIMIT $3[0m  [["cart_id", 1], ["product_id", 3], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:68:in `add_to_cart'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 131ms (Views: 0.3ms | ActiveRecord: 12.9ms | Allocations: 42773)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-10 00:48:44 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>3, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:53:in `add_to_cart'
  [1m[36mCart Load (0.2ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:62:in `add_to_cart'
  [1m[36mOrderItem Load (0.3ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."cart_id" = $1 AND "order_items"."product_id" = $2 LIMIT $3[0m  [["cart_id", 1], ["product_id", 3], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:67:in `add_to_cart'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 1076ms (Views: 0.2ms | ActiveRecord: 14.5ms | Allocations: 1012482)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started PATCH "/carts/1/add_quantity/1" for 127.0.0.1 at 2023-10-10 00:59:30 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_quantity as */*
  Parameters: {"quantity"=>2, "id"=>"1", "product_id"=>"1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:159:in `add_quantity'
  [1m[36mOrderItem Load (0.4ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."cart_id" = $1 AND "order_items"."id" IS NULL LIMIT $2[0m  [["cart_id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:166:in `add_quantity'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 404 Not Found in 108ms (Views: 0.3ms | ActiveRecord: 8.5ms | Allocations: 28900)


  [1m[36mCart Load (0.8ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[36mOrderItem Load (0.6ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items"[0m
Started PATCH "/carts/1/add_quantity/1" for 127.0.0.1 at 2023-10-10 11:09:26 +0300
Processing by CartsController#add_quantity as */*
  Parameters: {"quantity"=>2, "id"=>"1", "product_id"=>"1"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.4ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:159:in `add_quantity'
  [1m[36mOrderItem Load (0.5ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."cart_id" = $1 AND "order_items"."id" IS NULL LIMIT $2[0m  [["cart_id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:166:in `add_quantity'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 404 Not Found in 43ms (Views: 0.2ms | ActiveRecord: 9.2ms | Allocations: 7132)


Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-10 11:24:09 +0300
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>3, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
Current User: #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>
  [1m[36mProduct Load (0.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:54:in `add_to_cart'
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:63:in `add_to_cart'
  [1m[36mOrderItem Load (0.4ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."cart_id" = $1 AND "order_items"."product_id" = $2 LIMIT $3[0m  [["cart_id", 1], ["product_id", 3], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:68:in `add_to_cart'
Completed 500 Internal Server Error in 100ms (ActiveRecord: 11.1ms | Allocations: 19910)


  
NoMethodError (undefined method `orders' for #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>):
  
app/controllers/carts_controller.rb:75:in `add_to_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-10 11:24:20 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>3, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
Current User: #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:54:in `add_to_cart'
  [1m[36mCart Load (0.4ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:63:in `add_to_cart'
  [1m[36mOrderItem Load (0.4ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."cart_id" = $1 AND "order_items"."product_id" = $2 LIMIT $3[0m  [["cart_id", 1], ["product_id", 3], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:68:in `add_to_cart'
Completed 500 Internal Server Error in 128ms (ActiveRecord: 14.3ms | Allocations: 41422)


  
NoMethodError (undefined method `orders' for #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>):
  
app/controllers/carts_controller.rb:75:in `add_to_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-10 11:25:49 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>3, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
Current User: #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>
  [1m[36mProduct Load (0.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:54:in `add_to_cart'
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:63:in `add_to_cart'
  [1m[36mOrderItem Load (0.3ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."cart_id" = $1 AND "order_items"."product_id" = $2 LIMIT $3[0m  [["cart_id", 1], ["product_id", 3], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:68:in `add_to_cart'
Completed 500 Internal Server Error in 133ms (ActiveRecord: 11.1ms | Allocations: 41768)


  
NoMethodError (undefined method `orders' for #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>):
  
app/controllers/carts_controller.rb:75:in `add_to_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-10 11:48:00 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>3, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
Current User: #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>
  [1m[36mProduct Load (0.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:12:in `add_to_cart'
  [1m[36mCart Load (0.2ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:22:in `add_to_cart'
  [1m[36mOrderItem Load (0.3ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."cart_id" = $1 AND "order_items"."product_id" = $2 LIMIT $3[0m  [["cart_id", 1], ["product_id", 3], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:27:in `add_to_cart'
No template found for CartsController#add_to_cart, rendering head :no_content
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 204 No Content in 130ms (ActiveRecord: 13.3ms | Allocations: 43632)


Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-10 11:48:56 +0300
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>3, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
Current User: #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>
  [1m[36mProduct Load (0.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:54:in `add_to_cart'
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:63:in `add_to_cart'
  [1m[36mOrderItem Load (0.6ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."cart_id" = $1 AND "order_items"."product_id" = $2 LIMIT $3[0m  [["cart_id", 1], ["product_id", 3], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:68:in `add_to_cart'
Completed 500 Internal Server Error in 99ms (ActiveRecord: 9.0ms | Allocations: 25803)


  
NoMethodError (undefined method `orders' for #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>):
  
app/controllers/carts_controller.rb:75:in `add_to_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[36mOrderItem Load (0.4ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items"[0m
  [1m[36mOrder Load (0.7ms)[0m  [1m[34mSELECT "orders".* FROM "orders"[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-10 11:54:46 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>3, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
Current User: #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:54:in `add_to_cart'
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:63:in `add_to_cart'
  [1m[36mOrderItem Load (0.3ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."cart_id" = $1 AND "order_items"."product_id" = $2 LIMIT $3[0m  [["cart_id", 1], ["product_id", 3], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:68:in `add_to_cart'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 1096ms (Views: 0.3ms | ActiveRecord: 13.9ms | Allocations: 1012954)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-10 11:59:37 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>3, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
Current User: #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:54:in `add_to_cart'
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:63:in `add_to_cart'
Completed 500 Internal Server Error in 124ms (ActiveRecord: 9.8ms | Allocations: 37329)


  
NoMethodError (undefined method `orders' for #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>):
  
app/controllers/carts_controller.rb:68:in `add_to_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-10 12:05:25 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>3, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
Current User: #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>
  [1m[36mProduct Load (0.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:54:in `add_to_cart'
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:63:in `add_to_cart'
  [1m[36mOrder Load (0.2ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."user_id" = $1 /* loading for inspect */ LIMIT $2[0m  [["user_id", 2], ["LIMIT", 11]]
Completed 500 Internal Server Error in 125ms (ActiveRecord: 10.5ms | Allocations: 38604)


  [1m[36mCACHE Order Load (0.0ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."user_id" = $1 /* loading for inspect */ LIMIT $2[0m  [["user_id", 2], ["LIMIT", 11]]
  
NoMethodError (private method `open' called for #<ActiveRecord::Associations::CollectionProxy []>):
  
app/controllers/carts_controller.rb:68:in `add_to_cart'
  [1m[36mCACHE Order Load (0.0ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."user_id" = $1 /* loading for inspect */ LIMIT $2[0m  [["user_id", 2], ["LIMIT", 11]]
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-10 12:06:25 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>3, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
Current User: #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:54:in `add_to_cart'
  [1m[36mCart Load (0.2ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:63:in `add_to_cart'
  [1m[36mOrderItem Load (0.4ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."cart_id" = $1 AND "order_items"."product_id" = $2 LIMIT $3[0m  [["cart_id", 1], ["product_id", 3], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:71:in `add_to_cart'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/carts_controller.rb:82:in `add_to_cart'
  [1m[36mOrder Create (0.9ms)[0m  [1m[32mINSERT INTO "orders" ("user_id", "status", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["user_id", 2], ["status", "open"], ["created_at", "2023-10-10 09:06:25.799657"], ["updated_at", "2023-10-10 09:06:25.799657"]]
  ↳ app/controllers/carts_controller.rb:82:in `add_to_cart'
  [1m[36mTRANSACTION (19.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/carts_controller.rb:82:in `add_to_cart'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 1212ms (Views: 0.3ms | ActiveRecord: 36.4ms | Allocations: 1020559)


Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-10 12:07:48 +0300
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
Current User: #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>
  [1m[36mProduct Load (0.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:54:in `add_to_cart'
  [1m[36mCart Load (0.4ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:63:in `add_to_cart'
  [1m[36mOrderItem Load (0.4ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."cart_id" = $1 AND "order_items"."product_id" = $2 LIMIT $3[0m  [["cart_id", 1], ["product_id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:71:in `add_to_cart'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/carts_controller.rb:82:in `add_to_cart'
  [1m[36mOrder Create (0.4ms)[0m  [1m[32mINSERT INTO "orders" ("user_id", "status", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["user_id", 2], ["status", "open"], ["created_at", "2023-10-10 09:07:48.096554"], ["updated_at", "2023-10-10 09:07:48.096554"]]
  ↳ app/controllers/carts_controller.rb:82:in `add_to_cart'
  [1m[36mTRANSACTION (17.8ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/carts_controller.rb:82:in `add_to_cart'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 47ms (Views: 0.6ms | ActiveRecord: 20.9ms | Allocations: 7840)


Started POST "/carts/2/add_to_cart" for 127.0.0.1 at 2023-10-10 12:08:03 +0300
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"2"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
Current User: #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:54:in `add_to_cart'
  [1m[36mCart Load (0.2ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:63:in `add_to_cart'
  [1m[36mOrderItem Load (0.5ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."cart_id" = $1 AND "order_items"."product_id" = $2 LIMIT $3[0m  [["cart_id", 1], ["product_id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:71:in `add_to_cart'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/carts_controller.rb:82:in `add_to_cart'
  [1m[36mOrder Create (0.5ms)[0m  [1m[32mINSERT INTO "orders" ("user_id", "status", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["user_id", 2], ["status", "open"], ["created_at", "2023-10-10 09:08:03.656409"], ["updated_at", "2023-10-10 09:08:03.656409"]]
  ↳ app/controllers/carts_controller.rb:82:in `add_to_cart'
  [1m[36mTRANSACTION (58.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/carts_controller.rb:82:in `add_to_cart'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 79ms (Views: 0.2ms | ActiveRecord: 60.8ms | Allocations: 7730)


Started POST "/carts/add_to_cart" for 127.0.0.1 at 2023-10-10 12:08:09 +0300
  
ActionController::RoutingError (No route matches [POST] "/carts/add_to_cart"):
  
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-10 12:08:26 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
Current User: #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:54:in `add_to_cart'
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:63:in `add_to_cart'
  [1m[36mOrderItem Load (0.3ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."cart_id" = $1 AND "order_items"."product_id" = $2 LIMIT $3[0m  [["cart_id", 1], ["product_id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:71:in `add_to_cart'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/carts_controller.rb:82:in `add_to_cart'
  [1m[36mOrder Create (0.5ms)[0m  [1m[32mINSERT INTO "orders" ("user_id", "status", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["user_id", 2], ["status", "open"], ["created_at", "2023-10-10 09:08:26.690397"], ["updated_at", "2023-10-10 09:08:26.690397"]]
  ↳ app/controllers/carts_controller.rb:82:in `add_to_cart'
  [1m[36mTRANSACTION (12.5ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/carts_controller.rb:82:in `add_to_cart'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 1177ms (Views: 0.2ms | ActiveRecord: 29.0ms | Allocations: 1020570)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-10 12:16:29 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
Current User: #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:54:in `add_to_cart'
Completed 500 Internal Server Error in 111ms (ActiveRecord: 10.6ms | Allocations: 29651)


  
NoMethodError (undefined method `cart' for #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>):
  
app/controllers/carts_controller.rb:63:in `add_to_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-10 12:17:00 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
Current User: #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>
  [1m[36mProduct Load (0.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:54:in `add_to_cart'
Completed 500 Internal Server Error in 95ms (ActiveRecord: 6.9ms | Allocations: 29641)


  
NoMethodError (undefined method `cart' for #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>):
  
app/controllers/carts_controller.rb:63:in `add_to_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-10 12:19:43 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
Current User: #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:54:in `add_to_cart'
Completed 500 Internal Server Error in 95ms (ActiveRecord: 7.8ms | Allocations: 29641)


  
NoMethodError (undefined method `cart' for #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>):
  
app/controllers/carts_controller.rb:63:in `add_to_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-10 12:21:21 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
Current User: #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:54:in `add_to_cart'
  [1m[36mCart Load (0.2ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:63:in `add_to_cart'
Completed 500 Internal Server Error in 129ms (ActiveRecord: 13.4ms | Allocations: 43633)


  
NoMethodError (undefined method `cart' for #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>):
  
app/controllers/carts_controller.rb:71:in `add_to_cart'
Started POST "/carts/2/add_to_cart" for 127.0.0.1 at 2023-10-10 12:21:46 +0300
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"2"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
Current User: #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:54:in `add_to_cart'
  [1m[36mCart Load (0.4ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:63:in `add_to_cart'
Completed 500 Internal Server Error in 20ms (ActiveRecord: 1.1ms | Allocations: 8662)


  
NoMethodError (undefined method `cart' for #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>):
  
app/controllers/carts_controller.rb:71:in `add_to_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-10 12:22:08 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
Current User: #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:54:in `add_to_cart'
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:63:in `add_to_cart'
Completed 500 Internal Server Error in 129ms (ActiveRecord: 14.5ms | Allocations: 43632)


  
NoMethodError (undefined method `cart' for #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>):
  
app/controllers/carts_controller.rb:71:in `add_to_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-10 12:23:50 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
Current User: #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:54:in `add_to_cart'
  [1m[36mCart Load (0.4ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:63:in `add_to_cart'
  [1m[36mOrderItem Load (0.5ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."cart_id" = $1 AND "order_items"."product_id" = $2 LIMIT $3[0m  [["cart_id", 1], ["product_id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:68:in `add_to_cart'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 1155ms (Views: 0.3ms | ActiveRecord: 15.8ms | Allocations: 1012651)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-10 12:25:18 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:53:in `add_to_cart'
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:62:in `add_to_cart'
  [1m[36mOrderItem Load (0.3ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."cart_id" = $1 AND "order_items"."product_id" = $2 LIMIT $3[0m  [["cart_id", 1], ["product_id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:67:in `add_to_cart'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 1082ms (Views: 0.3ms | ActiveRecord: 12.5ms | Allocations: 1012473)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-10 12:29:25 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:53:in `add_to_cart'
  [1m[36mCart Load (0.2ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:62:in `add_to_cart'
Completed 500 Internal Server Error in 114ms (ActiveRecord: 11.3ms | Allocations: 34765)


  
NoMethodError (undefined method `orders' for #<Cart id: 1, user_id: 2, created_at: "2023-10-09 20:32:06.805325000 +0000", updated_at: "2023-10-09 20:32:06.805325000 +0000">
Did you mean?  order_items):
  
app/controllers/carts_controller.rb:67:in `add_to_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-10 12:33:09 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:53:in `add_to_cart'
  [1m[36mCart Load (0.2ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:62:in `add_to_cart'
Completed 500 Internal Server Error in 116ms (ActiveRecord: 11.9ms | Allocations: 34488)


  
ActiveRecord::StatementInvalid (PG::UndefinedColumn: ERROR:  column orders.cart_id does not exist
LINE 1: SELECT "orders".* FROM "orders" WHERE "orders"."cart_id" = $...
                                              ^
):
  
app/controllers/carts_controller.rb:67:in `add_to_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3422183495574815895)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to AddCartReferenceToOrders (20231010093453)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (13.9ms)[0m  [1m[35mALTER TABLE "orders" ADD "cart_id" bigint NOT NULL[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT pg_advisory_unlock(3422183495574815895)[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3422183495574815895)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to AddCartReferenceToOrders (20231010093453)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts" ORDER BY "carts"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "orders" ADD "cart_id" bigint DEFAULT 1 NOT NULL[0m
  [1m[35m (34.8ms)[0m  [1m[35mCREATE INDEX "index_orders_on_cart_id" ON "orders" ("cart_id")[0m
  [1m[35m (1.7ms)[0m  [1m[35mALTER TABLE "orders" ADD CONSTRAINT "fk_rails_5cdf0e0ad4"
FOREIGN KEY ("cart_id")
  REFERENCES "carts" ("id")
[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20231010093453"]]
  [1m[36mTRANSACTION (14.7ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(3422183495574815895)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-10 12:43:48 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
  [1m[36mProduct Load (0.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:53:in `add_to_cart'
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:62:in `add_to_cart'
  [1m[36mOrder Load (0.6ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."cart_id" = $1 AND "orders"."status" = $2 LIMIT $3[0m  [["cart_id", 1], ["status", "open"], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:67:in `add_to_cart'
  [1m[36mOrderItem Load (0.4ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1 AND "order_items"."product_id" = $2 LIMIT $3[0m  [["order_id", 1], ["product_id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:70:in `add_to_cart'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 1155ms (Views: 0.2ms | ActiveRecord: 19.7ms | Allocations: 1018004)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-10 12:44:50 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:53:in `add_to_cart'
  [1m[36mCart Load (0.2ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:62:in `add_to_cart'
  [1m[36mOrder Load (0.3ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."cart_id" = $1 AND "orders"."status" = $2 LIMIT $3[0m  [["cart_id", 1], ["status", "open"], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:67:in `add_to_cart'
  [1m[36mOrderItem Load (0.4ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1 AND "order_items"."product_id" = $2 LIMIT $3[0m  [["order_id", 1], ["product_id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:70:in `add_to_cart'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 1201ms (Views: 0.2ms | ActiveRecord: 15.7ms | Allocations: 1018048)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-10 12:55:03 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:53:in `add_to_cart'
  [1m[36mCart Load (0.5ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:62:in `add_to_cart'
  [1m[36mOrder Load (0.7ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."cart_id" = $1 AND "orders"."status" = $2 LIMIT $3[0m  [["cart_id", 1], ["status", "open"], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:67:in `add_to_cart'
  [1m[36mOrderItem Load (0.3ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1 AND "order_items"."product_id" = $2 LIMIT $3[0m  [["order_id", 1], ["product_id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:70:in `add_to_cart'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 1091ms (Views: 0.2ms | ActiveRecord: 18.4ms | Allocations: 1018035)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[36mCart Load (0.5ms)[0m  [1m[34mSELECT "carts".* FROM "carts"[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/add_to_cart" for 127.0.0.1 at 2023-10-10 12:56:52 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
ActionController::RoutingError (No route matches [POST] "/add_to_cart"):
  
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-10 12:56:59 +0300
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:53:in `add_to_cart'
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:62:in `add_to_cart'
  [1m[36mOrder Load (0.4ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."cart_id" = $1 AND "orders"."status" = $2 LIMIT $3[0m  [["cart_id", 1], ["status", "open"], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:67:in `add_to_cart'
  [1m[36mOrderItem Load (0.6ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1 AND "order_items"."product_id" = $2 LIMIT $3[0m  [["order_id", 1], ["product_id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:70:in `add_to_cart'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 1138ms (Views: 0.2ms | ActiveRecord: 17.5ms | Allocations: 1018002)


  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.2ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-10 12:59:29 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:53:in `add_to_cart'
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:62:in `add_to_cart'
  [1m[36mOrder Load (0.4ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."cart_id" = $1 AND "orders"."status" = $2 LIMIT $3[0m  [["cart_id", 1], ["status", "open"], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:67:in `add_to_cart'
  [1m[36mOrderItem Load (0.4ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1 AND "order_items"."product_id" = $2 LIMIT $3[0m  [["order_id", 1], ["product_id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:70:in `add_to_cart'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 1163ms (Views: 0.2ms | ActiveRecord: 18.1ms | Allocations: 1018059)


  [1m[36mOrderItem Load (0.7ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items"[0m
  [1m[36mOrder Load (0.4ms)[0m  [1m[34mSELECT "orders".* FROM "orders"[0m
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-10 13:10:26 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:53:in `add_to_cart'
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:62:in `add_to_cart'
  [1m[36mOrder Load (0.4ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."cart_id" = $1 AND "orders"."status" = $2 LIMIT $3[0m  [["cart_id", 1], ["status", "open"], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:67:in `add_to_cart'
  [1m[36mOrderItem Load (0.4ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1 AND "order_items"."product_id" = $2 LIMIT $3[0m  [["order_id", 1], ["product_id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:70:in `add_to_cart'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 1124ms (Views: 0.2ms | ActiveRecord: 17.2ms | Allocations: 1018054)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-10 13:13:09 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:53:in `add_to_cart'
Completed 500 Internal Server Error in 114ms (ActiveRecord: 10.8ms | Allocations: 31211)


  
ActiveModel::MissingAttributeError (can't write unknown attribute `current_cart_id`

          raise ActiveModel::MissingAttributeError, "can't write unknown attribute `#{name}`"
          ^^^^^):
  
app/controllers/carts_controller.rb:63:in `add_to_cart'
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-10 13:24:10 +0300
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>1, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:53:in `add_to_cart'
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:62:in `add_to_cart'
  [1m[36mOrder Load (0.3ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."cart_id" = $1 AND "orders"."status" = $2 LIMIT $3[0m  [["cart_id", 1], ["status", "open"], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:67:in `add_to_cart'
  [1m[36mOrderItem Load (0.4ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1 AND "order_items"."product_id" = $2 LIMIT $3[0m  [["order_id", 1], ["product_id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:70:in `add_to_cart'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 1106ms (Views: 0.2ms | ActiveRecord: 15.6ms | Allocations: 1005858)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-10 13:25:33 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>80, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 80], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:53:in `add_to_cart'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 404 Not Found in 93ms (Views: 0.3ms | ActiveRecord: 6.6ms | Allocations: 20189)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-10 13:26:46 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>10, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
  [1m[36mProduct Load (0.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:53:in `add_to_cart'
  [1m[36mCart Load (0.4ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:62:in `add_to_cart'
  [1m[36mOrder Load (0.4ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."cart_id" = $1 AND "orders"."status" = $2 LIMIT $3[0m  [["cart_id", 1], ["status", "open"], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:67:in `add_to_cart'
  [1m[36mOrderItem Load (0.6ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1 AND "order_items"."product_id" = $2 LIMIT $3[0m  [["order_id", 1], ["product_id", 10], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:70:in `add_to_cart'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 1158ms (Views: 0.2ms | ActiveRecord: 19.7ms | Allocations: 1018061)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-11 21:43:51 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (7.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>10, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (20.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
  [1m[36mProduct Load (23.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:53:in `add_to_cart'
  [1m[36mCart Load (17.7ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:62:in `add_to_cart'
  [1m[36mOrder Load (17.9ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."cart_id" = $1 AND "orders"."status" = $2 LIMIT $3[0m  [["cart_id", 1], ["status", "open"], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:67:in `add_to_cart'
  [1m[36mOrderItem Load (12.7ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1 AND "order_items"."product_id" = $2 LIMIT $3[0m  [["order_id", 1], ["product_id", 10], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:70:in `add_to_cart'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 1663ms (Views: 0.3ms | ActiveRecord: 153.3ms | Allocations: 1018061)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:19)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-11 22:08:47 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>10, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
  [1m[36mProduct Load (0.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:53:in `add_to_cart'
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:62:in `add_to_cart'
  [1m[36mOrder Load (0.4ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."cart_id" = $1 AND "orders"."status" = $2 LIMIT $3[0m  [["cart_id", 1], ["status", "open"], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:67:in `add_to_cart'
  [1m[36mOrderItem Load (0.5ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1 AND "order_items"."product_id" = $2 LIMIT $3[0m  [["order_id", 1], ["product_id", 10], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:70:in `add_to_cart'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 1148ms (Views: 0.2ms | ActiveRecord: 18.5ms | Allocations: 1018040)


Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-11 22:10:09 +0300
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>10, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
  [1m[36mProduct Load (0.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:53:in `add_to_cart'
  [1m[36mCart Load (0.2ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:62:in `add_to_cart'
  [1m[36mOrder Load (0.4ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."cart_id" = $1 AND "orders"."status" = $2 LIMIT $3[0m  [["cart_id", 1], ["status", "open"], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:67:in `add_to_cart'
  [1m[36mOrderItem Load (0.2ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1 AND "order_items"."product_id" = $2 LIMIT $3[0m  [["order_id", 1], ["product_id", 10], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:70:in `add_to_cart'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 103ms (Views: 0.2ms | ActiveRecord: 12.8ms | Allocations: 28706)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-11 22:12:45 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>10, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:53:in `add_to_cart'
Completed 500 Internal Server Error in 99ms (ActiveRecord: 7.4ms | Allocations: 29580)


  
NoMethodError (undefined method `current_cart' for #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>
Did you mean?  current_password):
  
app/controllers/carts_controller.rb:62:in `add_to_cart'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-11 22:13:19 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>10, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:53:in `add_to_cart'
  [1m[36mCart Load (0.2ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:62:in `add_to_cart'
  [1m[36mOrder Load (0.3ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."cart_id" = $1 AND "orders"."status" = $2 LIMIT $3[0m  [["cart_id", 1], ["status", "open"], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:67:in `add_to_cart'
  [1m[36mOrderItem Load (0.4ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1 AND "order_items"."product_id" = $2 LIMIT $3[0m  [["order_id", 1], ["product_id", 10], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:70:in `add_to_cart'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 1131ms (Views: 0.3ms | ActiveRecord: 14.8ms | Allocations: 1018006)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-11 22:15:17 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>10, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:95:in `add_to_cart'
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:104:in `add_to_cart'
  [1m[36mOrder Load (0.3ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."cart_id" = $1 AND "orders"."status" = $2 LIMIT $3[0m  [["cart_id", 1], ["status", "open"], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:109:in `add_to_cart'
  [1m[36mOrderItem Load (0.4ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1 AND "order_items"."product_id" = $2 LIMIT $3[0m  [["order_id", 1], ["product_id", 10], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:112:in `add_to_cart'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 200 OK in 143ms (Views: 0.3ms | ActiveRecord: 15.2ms | Allocations: 46753)


Started POST "/carts/1/add_to_cart" for 127.0.0.1 at 2023-10-11 22:16:45 +0300
Processing by CartsController#add_to_cart as */*
  Parameters: {"product_id"=>10, "quantity"=>2, "id"=>"1"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
  [1m[36mProduct Load (0.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:95:in `add_to_cart'
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:104:in `add_to_cart'
  [1m[36mOrder Load (0.6ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."cart_id" = $1 AND "orders"."status" = $2 LIMIT $3[0m  [["cart_id", 1], ["status", "open"], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:109:in `add_to_cart'
  [1m[36mOrderItem Load (0.3ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1 AND "order_items"."product_id" = $2 LIMIT $3[0m  [["order_id", 1], ["product_id", 10], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:112:in `add_to_cart'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 200 OK in 16ms (Views: 0.3ms | ActiveRecord: 2.5ms | Allocations: 5189)


Started PATCH "/carts/1/add_quantity/1" for 127.0.0.1 at 2023-10-11 22:23:50 +0300
Processing by CartsController#add_quantity as */*
  Parameters: {"quantity"=>2, "id"=>"1", "product_id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 50ms (ActiveRecord: 6.9ms | Allocations: 10541)


  
NoMethodError (undefined method `cart' for #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>):
  
app/controllers/carts_controller.rb:196:in `add_quantity'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started PATCH "/carts/1/add_quantity/1" for 127.0.0.1 at 2023-10-11 22:24:05 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_quantity as */*
  Parameters: {"quantity"=>2, "id"=>"1", "product_id"=>"1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 83ms (ActiveRecord: 4.8ms | Allocations: 20987)


  
NoMethodError (undefined method `cart' for #<User id: 2, provider: "email", uid: "markpaul1@gmail.com", allow_password_change: [FILTERED], name: nil, nickname: nil, image: nil, email: "markpaul1@gmail.com", created_at: "2023-10-09 20:31:24.546947000 +0000", updated_at: "2023-10-09 20:31:24.609509000 +0000", role: nil>):
  
app/controllers/carts_controller.rb:196:in `add_quantity'
DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started PATCH "/carts/1/add_quantity/1" for 127.0.0.1 at 2023-10-11 22:28:57 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_quantity as */*
  Parameters: {"quantity"=>2, "id"=>"1", "product_id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.2ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:196:in `add_quantity'
  [1m[36mOrderItem Load (0.3ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."cart_id" = $1 AND "order_items"."id" IS NULL LIMIT $2[0m  [["cart_id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:203:in `add_quantity'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 404 Not Found in 107ms (Views: 0.3ms | ActiveRecord: 8.3ms | Allocations: 28838)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
Started PATCH "/carts/1/add_quantity/1" for 127.0.0.1 at 2023-10-11 22:31:03 +0300
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Non-URL-safe CSRF tokens are deprecated. Use 6.1 defaults or above. (called from <top (required)> at /home/markpaul/projects/skyva-api/app/controllers/application_controller.rb:1)
Processing by CartsController#add_quantity as */*
  Parameters: {"quantity"=>2, "id"=>"1", "product_id"=>"1"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "markpaul1@gmail.com"], ["LIMIT", 1]]
  [1m[36mCart Load (0.3ms)[0m  [1m[34mSELECT "carts".* FROM "carts" WHERE "carts"."user_id" = $1 LIMIT $2[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:196:in `add_quantity'
  [1m[36mOrderItem Load (0.5ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."cart_id" = $1 AND "order_items"."id" IS NULL LIMIT $2[0m  [["cart_id", 1], ["LIMIT", 1]]
  ↳ app/controllers/carts_controller.rb:203:in `add_quantity'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 404 Not Found in 111ms (Views: 0.4ms | ActiveRecord: 9.9ms | Allocations: 28819)


DEPRECATION WARNING: Using legacy connection handling is deprecated. Please set
`legacy_connection_handling` to `false` in your application.

The new connection handling does not support `connection_handlers`
getter and setter.

Read more about how to migrate at: https://guides.rubyonrails.org/active_record_multiple_databases.html#migrate-to-the-new-connection-handling
 (called from <top (required)> at /home/markpaul/projects/skyva-api/app/models/user.rb:3)
  [1m[36mOrderItem Load (0.7ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items"[0m
